/*! For license information please see ooxml-templater.min.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.OOXMLTemplater=t():e.OOXMLTemplater=t()}(this,()=>(()=>{var e={14:(e,t,n)=>{"use strict";var r=n(287).hp;const{randomFillSync:i}=n(93),o=n(243),s=new Uint32Array(256).map((e,t)=>{for(let e=0;e<8;e++)1&t?t=t>>>1^3988292384:t>>>=1;return t>>>0}),a=(e,t)=>Math.imul(e,t)>>>0,c=(e,t)=>s[255&(e^t)]^e>>>8,l=()=>"function"==typeof i?i(r.alloc(12)):l.node();l.node=()=>{const e=r.alloc(12),t=e.length;for(let n=0;n<t;n++)e[n]=256*Math.random()&255;return e};const f={genSalt:l};function u(e){const t=r.isBuffer(e)?e:r.from(e);this.keys=new Uint32Array([305419896,591751049,878082192]);for(let e=0;e<t.length;e++)this.updateKeys(t[e])}u.prototype.updateKeys=function(e){const t=this.keys;return t[0]=c(t[0],e),t[1]+=255&t[0],t[1]=a(t[1],134775813)+1,t[2]=c(t[2],t[1]>>>24),e},u.prototype.next=function(){const e=(2|this.keys[2])>>>0;return a(e,1^e)>>8&255},e.exports={decrypt:function(e,t,n){if(!e||!r.isBuffer(e)||e.length<12)return r.alloc(0);const i=function(e){const t=new u(e);return function(e){const n=r.alloc(e.length);let i=0;for(let r of e)n[i++]=t.updateKeys(r^t.next());return n}}(n),s=i(e.slice(0,12)),a=8&~t.flags?t.crc>>>24:t.timeHighByte;if(s[11]!==a)throw o.WRONG_PASSWORD();return i(e.slice(12))},encrypt:function(e,t,n,i=!1){null==e&&(e=r.alloc(0)),r.isBuffer(e)||(e=r.from(e.toString()));const o=function(e){const t=new u(e);return function(e,n,i=0){n||(n=r.alloc(e.length));for(let r of e){const e=t.next();n[i++]=r^e,t.updateKeys(r)}return n}}(n),s=f.genSalt();s[11]=t.crc>>>24&255,i&&(s[10]=t.crc>>>16&255);const a=r.alloc(e.length+12);return o(s,a),o(e,a,12)},_salter:function(e){r.isBuffer(e)&&e.length>=12?f.genSalt=function(){return e.slice(0,12)}:f.genSalt="node"===e?l.node:l}}},16:(e,t,n)=>{var r=n(287).hp,i=n(70),o=n(780),s=i.Constants,a=n(776);e.exports=function(e,t){var n=new o.EntryHeader,c=r.alloc(0),l=r.alloc(0),f=!1,u=null,d=r.alloc(0),h=r.alloc(0),p=!0;const m=e,g="object"==typeof m.decoder?m.decoder:i.decoder;function y(){return t&&t instanceof Uint8Array?(h=n.loadLocalHeaderFromBinary(t),t.slice(n.realDataOffset,n.realDataOffset+n.compressedSize)):r.alloc(0)}function E(e){if(n.flags_desc){const r={},o=n.realDataOffset+n.compressedSize;if(t.readUInt32LE(o)==s.LOCSIG||t.readUInt32LE(o)==s.CENSIG)throw i.Errors.DESCRIPTOR_NOT_EXIST();if(t.readUInt32LE(o)==s.EXTSIG)r.crc=t.readUInt32LE(o+s.EXTCRC),r.compressedSize=t.readUInt32LE(o+s.EXTSIZ),r.size=t.readUInt32LE(o+s.EXTLEN);else{if(19280!==t.readUInt16LE(o+12))throw i.Errors.DESCRIPTOR_UNKNOWN();r.crc=t.readUInt32LE(o+s.EXTCRC-4),r.compressedSize=t.readUInt32LE(o+s.EXTSIZ-4),r.size=t.readUInt32LE(o+s.EXTLEN-4)}if(r.compressedSize!==n.compressedSize||r.size!==n.size||r.crc!==n.crc)throw i.Errors.DESCRIPTOR_FAULTY();if(i.crc32(e)!==r.crc)return!1}else if(i.crc32(e)!==n.localHeader.crc)return!1;return!0}function w(e,t,o){if(void 0===t&&"string"==typeof e&&(o=e,e=void 0),f)return e&&t&&t(r.alloc(0),i.Errors.DIRECTORY_CONTENT_ERROR()),r.alloc(0);var s=y();if(0===s.length)return e&&t&&t(s),s;if(n.encrypted){if("string"!=typeof o&&!r.isBuffer(o))throw i.Errors.INVALID_PASS_PARAM();s=a.ZipCrypto.decrypt(s,n,o)}var l=r.alloc(n.size);switch(n.method){case i.Constants.STORED:if(s.copy(l),E(l))return e&&t&&t(l),l;throw e&&t&&t(l,i.Errors.BAD_CRC()),i.Errors.BAD_CRC();case i.Constants.DEFLATED:var u=new a.Inflater(s,n.size);if(!e){if(u.inflate(l).copy(l,0),!E(l))throw i.Errors.BAD_CRC(`"${g.decode(c)}"`);return l}u.inflateAsync(function(e){e.copy(e,0),t&&(E(e)?t(e):t(e,i.Errors.BAD_CRC()))});break;default:throw e&&t&&t(r.alloc(0),i.Errors.UNKNOWN_METHOD()),i.Errors.UNKNOWN_METHOD()}}function I(e,o){if((!u||!u.length)&&r.isBuffer(t))return e&&o&&o(y()),y();if(u.length&&!f){var s;switch(n.method){case i.Constants.STORED:return n.compressedSize=n.size,s=r.alloc(u.length),u.copy(s),e&&o&&o(s),s;default:case i.Constants.DEFLATED:var c=new a.Deflater(u);if(!e){var l=c.deflate();return n.compressedSize=l.length,l}c.deflateAsync(function(e){s=r.alloc(e.length),n.compressedSize=e.length,e.copy(s),o&&o(s)}),c=null}}else{if(!e||!o)return r.alloc(0);o(r.alloc(0))}}function D(e,t){return(e.readUInt32LE(t+4)<<4)+e.readUInt32LE(t)}function b(e){var t,r,i,o;e.length>=s.EF_ZIP64_SCOMP&&(t=D(e,s.EF_ZIP64_SUNCOMP),n.size===s.EF_ZIP64_OR_32&&(n.size=t)),e.length>=s.EF_ZIP64_RHO&&(r=D(e,s.EF_ZIP64_SCOMP),n.compressedSize===s.EF_ZIP64_OR_32&&(n.compressedSize=r)),e.length>=s.EF_ZIP64_DSN&&(i=D(e,s.EF_ZIP64_RHO),n.offset===s.EF_ZIP64_OR_32&&(n.offset=i)),e.length>=s.EF_ZIP64_DSN+4&&(o=e.readUInt32LE(s.EF_ZIP64_DSN),n.diskNumStart===s.EF_ZIP64_OR_16&&(n.diskNumStart=o))}return p=!!g.hasOwnProperty("efs")&&g.efs,{get entryName(){return g.decode(c)},get rawEntryName(){return c},set entryName(e){var t=(c=i.toBuffer(e,g.encode))[c.length-1];f=47===t||92===t,n.fileNameLength=c.length},get efs(){return"function"==typeof p?p(this.entryName):p},get extra(){return d},set extra(e){d=e,n.extraLength=e.length,function(e){try{for(var t,n,r,o=0;o+4<e.length;)t=e.readUInt16LE(o),o+=2,n=e.readUInt16LE(o),o+=2,r=e.slice(o,o+n),o+=n,s.ID_ZIP64===t&&b(r)}catch(e){throw i.Errors.EXTRA_FIELD_PARSE_ERROR()}}(e)},get comment(){return g.decode(l)},set comment(e){if(l=i.toBuffer(e,g.encode),n.commentLength=l.length,l.length>65535)throw i.Errors.COMMENT_TOO_LONG()},get name(){var e=g.decode(c);return f?e.substr(e.length-1).split("/").pop():e.split("/").pop()},get isDirectory(){return f},getCompressedData:function(){return I(!1,null)},getCompressedDataAsync:function(e){I(!0,e)},setData:function(e){u=i.toBuffer(e,i.decoder.encode),!f&&u.length?(n.size=u.length,n.method=i.Constants.DEFLATED,n.crc=i.crc32(e),n.changed=!0):n.method=i.Constants.STORED},getData:function(e){return n.changed?u:w(!1,null,e)},getDataAsync:function(e,t){n.changed?e(u):w(!0,e,t)},set attr(e){n.attr=e},get attr(){return n.attr},set header(e){n.loadFromBinary(e)},get header(){return n},packCentralHeader:function(){n.flags_efs=this.efs,n.extraLength=d.length;var e=n.centralHeaderToBinary(),t=i.Constants.CENHDR;return c.copy(e,t),t+=c.length,d.copy(e,t),t+=n.extraLength,l.copy(e,t),e},packLocalHeader:function(){let e=0;n.flags_efs=this.efs,n.extraLocalLength=h.length;const t=n.localHeaderToBinary(),i=r.alloc(t.length+c.length+n.extraLocalLength);return t.copy(i,e),e+=t.length,c.copy(i,e),e+=c.length,h.copy(i,e),e+=h.length,i},toJSON:function(){const e=function(e){return"<"+(e&&e.length+" bytes buffer"||"null")+">"};return{entryName:this.entryName,name:this.name,comment:this.comment,isDirectory:this.isDirectory,header:n.toJSON(),compressedData:e(t),data:e(u)}},toString:function(){return JSON.stringify(this.toJSON(),null,"\t")}}}},21:()=>{},36:e=>{e.exports=class{constructor(){this.handlers={word:this.deleteWordPage.bind(this),powerpoint:this.deletePowerPointSlide.bind(this),excel:this.deleteExcelRow.bind(this)}}processDeleteDirectives(e,t,n,r){const i={deletedPages:[],deletedSlides:[],deletedRows:[],modifiedFiles:new Map(n),success:!0,errors:[]},o=this.groupDirectivesByType(e,t);return o.pages.length>0&&this.processPageDeletions(o.pages,i),o.slides.length>0&&this.processSlideDeletions(o.slides,i),o.rows.length>0&&this.processRowDeletions(o.rows,i),i}groupDirectivesByType(e,t){const n={pages:[],slides:[],rows:[],sections:[]};for(const r of e){const e=this.getDataValue(t,r.cleanName);if(this.isEmptyValue(e))switch(r.deleteType||this.inferDeleteType(r)){case"page":n.pages.push(r);break;case"slide":n.slides.push(r);break;case"row":n.rows.push(r);break;case"section":n.sections.push(r)}}return n}inferDeleteType(e){const t=e.position?.fileType,n=e.directive?.toLowerCase()||"";return n.includes("page")||"word"===t?"page":n.includes("slide")||"powerpoint"===t?"slide":n.includes("row")||"excel"===t?"row":"unknown"}processPageDeletions(e,t){const n=this.groupByFile(e);for(const[e,r]of n)try{const n=t.modifiedFiles.get(e);if(!n)continue;const i=this.deleteWordPage(n,r);i.success?(t.modifiedFiles.set(e,i.modifiedFile),t.deletedPages.push(...i.deletedPages)):t.errors.push({file:e,type:"page",error:i.error})}catch(n){t.success=!1,t.errors.push({file:e,type:"page",error:n.message})}}processSlideDeletions(e,t){const n=this.groupByFile(e);for(const[e,r]of n)try{const n=t.modifiedFiles.get(e);if(!n)continue;const i=this.deletePowerPointSlide(n,r);i.success?(t.modifiedFiles.set(e,i.modifiedFile),t.deletedSlides.push(...i.deletedSlides)):t.errors.push({file:e,type:"slide",error:i.error})}catch(n){t.success=!1,t.errors.push({file:e,type:"slide",error:n.message})}}processRowDeletions(e,t){const n=this.groupByFile(e);for(const[e,r]of n)try{const n=t.modifiedFiles.get(e);if(!n)continue;const i=this.deleteExcelRow(n,r);i.success?(t.modifiedFiles.set(e,i.modifiedFile),t.deletedRows.push(...i.deletedRows)):t.errors.push({file:e,type:"row",error:i.error})}catch(n){t.success=!1,t.errors.push({file:e,type:"row",error:n.message})}}deleteWordPage(e,t){try{let n=e.content;const r=[];for(const e of t){const t=this.findPageBoundaries(n,e.position.index);if(t.found){const i=n.slice(0,t.start),o=n.slice(t.end);n=i+o,r.push({directive:e.cleanName,startIndex:t.start,endIndex:t.end,pageNumber:t.pageNumber})}}return{success:!0,modifiedFile:{...e,content:n,modified:!0},deletedPages:r}}catch(t){return{success:!1,error:t.message,modifiedFile:e,deletedPages:[]}}}findPageBoundaries(e,t){const n=this.findContainingElement(e,t,"w:p");if(!n)return{found:!1};const r=this.findPageBreakBefore(e,n.start),i=this.findPageBreakAfter(e,n.end),o=r?r.end:0;return{found:!0,start:o,end:i?i.start:e.length,pageNumber:this.estimatePageNumber(e,o)}}findContainingElement(e,t,n){const r=new RegExp(`<${n}[^>]*>`,"g"),i=new RegExp(`</${n}>`,"g");let o,s=null;for(;null!==(o=r.exec(e))&&!(o.index>t);)s=o;if(!s)return null;i.lastIndex=s.index;const a=i.exec(e);return a?{start:s.index,end:a.index+a[0].length,elementName:n}:null}findPageBreakBefore(e,t){const n=[/<w:br\s+w:type=["']page["']\s*\/>/g,/<w:sectPr[^>]*>/g];let r=null,i=-1;for(const o of n){let n;for(;null!==(n=o.exec(e))&&!(n.index>=t);)n.index>i&&(r=n,i=n.index+n[0].length);o.lastIndex=0}return r?{start:r.index,end:i,type:"pageBreak"}:null}findPageBreakAfter(e,t){const n=[/<w:br\s+w:type=["']page["']\s*\/>/,/<w:sectPr[^>]*>/],r=e.slice(t);let i=null,o=1/0;for(const e of n){const n=e.exec(r);n&&n.index<o&&(o=n.index,i={start:t+n.index,end:t+n.index+n[0].length,type:"pageBreak"})}return i}estimatePageNumber(e,t){const n=/<w:br\s+w:type=["']page["']\s*\/>/g;let r,i=1;for(;null!==(r=n.exec(e))&&!(r.index>=t);)i++;return i}deletePowerPointSlide(e,t){try{const n=e.path.match(/slide(\d+)\.xml$/i),r=n?parseInt(n[1],10):null;if(!r)return{success:!1,error:"Could not determine slide number from file path",modifiedFile:e,deletedSlides:[]};const i=[{directive:t.map(e=>e.cleanName).join(", "),slideNumber:r,filePath:e.path}];return{success:!0,modifiedFile:{...e,content:"",modified:!0,markedForDeletion:!0},deletedSlides:i}}catch(t){return{success:!1,error:t.message,modifiedFile:e,deletedSlides:[]}}}deleteExcelRow(e,t){try{let n=e.content;const r=[];for(const e of t){const t=this.findContainingElement(n,e.position.index,"row");if(t){const i=n.slice(0,t.start),o=n.slice(t.end);n=i+o,r.push({directive:e.cleanName,startIndex:t.start,endIndex:t.end})}}return{success:!0,modifiedFile:{...e,content:n,modified:!0},deletedRows:r}}catch(t){return{success:!1,error:t.message,modifiedFile:e,deletedRows:[]}}}groupByFile(e){const t=new Map;for(const n of e){const e=n.position?.file;e&&(t.has(e)||t.set(e,[]),t.get(e).push(n))}return t}getDataValue(e,t){if(!e||!t)return null;const n=t.split(".");let r=e;for(const e of n){if(null==r||"object"!=typeof r)return null;r=r[e]}return void 0===r?null:r}isEmptyValue(e){return null==e||"string"==typeof e&&""===e.trim()||!(!Array.isArray(e)||0!==e.length)||"object"==typeof e&&0===Object.keys(e).length}}},61:()=>{},70:(e,t,n)=>{e.exports=n(527),e.exports.Constants=n(383),e.exports.Errors=n(243),e.exports.FileAttr=n(819),e.exports.decoder=n(698)},92:(e,t,n)=>{"use strict";var r=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n.g)return n.g;throw new Error("unable to locate global object")}();e.exports=t=r.fetch,r.fetch&&(t.default=r.fetch.bind(r)),t.Headers=r.Headers,t.Request=r.Request,t.Response=r.Response},93:()=>{},138:(e,t,n)=>{var r=n(287).hp,i=n(70),o=i.Constants;e.exports=function(){var e=0,t=0,n=0,s=0,a=0;return{get diskEntries(){return e},set diskEntries(n){e=t=n},get totalEntries(){return t},set totalEntries(n){t=e=n},get size(){return n},set size(e){n=e},get offset(){return s},set offset(e){s=e},get commentLength(){return a},set commentLength(e){a=e},get mainHeaderSize(){return o.ENDHDR+a},loadFromBinary:function(r){if((r.length!==o.ENDHDR||r.readUInt32LE(0)!==o.ENDSIG)&&(r.length<o.ZIP64HDR||r.readUInt32LE(0)!==o.ZIP64SIG))throw i.Errors.INVALID_END();r.readUInt32LE(0)===o.ENDSIG?(e=r.readUInt16LE(o.ENDSUB),t=r.readUInt16LE(o.ENDTOT),n=r.readUInt32LE(o.ENDSIZ),s=r.readUInt32LE(o.ENDOFF),a=r.readUInt16LE(o.ENDCOM)):(e=i.readBigUInt64LE(r,o.ZIP64SUB),t=i.readBigUInt64LE(r,o.ZIP64TOT),n=i.readBigUInt64LE(r,o.ZIP64SIZE),s=i.readBigUInt64LE(r,o.ZIP64OFF),a=0)},toBinary:function(){var i=r.alloc(o.ENDHDR+a);return i.writeUInt32LE(o.ENDSIG,0),i.writeUInt32LE(0,4),i.writeUInt16LE(e,o.ENDSUB),i.writeUInt16LE(t,o.ENDTOT),i.writeUInt32LE(n,o.ENDSIZ),i.writeUInt32LE(s,o.ENDOFF),i.writeUInt16LE(a,o.ENDCOM),i.fill(" ",o.ENDHDR),i},toJSON:function(){return{diskEntries:e,totalEntries:t,size:n+" bytes",offset:function(e){let t=e.toString(16).toUpperCase();for(;t.length<4;)t="0"+t;return"0x"+t}(s),commentLength:a}},toString:function(){return JSON.stringify(this.toJSON(),null,"\t")}}}},154:()=>{},224:(e,t,n)=>{var r=n(287).hp;const i=n(16),o=n(780),s=n(70);e.exports=function(e,t){var n=[],a={},c=r.alloc(0),l=new o.MainHeader,f=!1;const u=new Set,d=t,{noSort:h,decoder:p}=d;function m(){if(f=!0,a={},l.diskEntries>(e.length-l.offset)/s.Constants.CENHDR)throw s.Errors.DISK_ENTRY_TOO_LARGE();n=new Array(l.diskEntries);for(var t=l.offset,r=0;r<n.length;r++){var o=t,c=new i(d,e);c.header=e.slice(o,o+=s.Constants.CENHDR),c.entryName=e.slice(o,o+=c.header.fileNameLength),c.header.extraLength&&(c.extra=e.slice(o,o+=c.header.extraLength)),c.header.commentLength&&(c.comment=e.slice(o,o+c.header.commentLength)),t+=c.header.centralHeaderSize,n[r]=c,a[c.entryName]=c}u.clear(),function(){const e=new Set;for(const t of Object.keys(a)){const n=t.split("/");if(n.pop(),n.length)for(let t=0;t<n.length;t++){const r=n.slice(0,t+1).join("/")+"/";e.add(r)}}for(const t of e)if(!(t in a)){const e=new i(d);e.entryName=t,e.attr=16,e.temporary=!0,n.push(e),a[e.entryName]=e,u.add(e)}}()}function g(){n.length>1&&!h&&n.sort((e,t)=>e.entryName.toLowerCase().localeCompare(t.entryName.toLowerCase()))}return e?function(t){var n=e.length-s.Constants.ENDHDR,r=Math.max(0,n-65535),i=r,o=e.length,a=-1,f=0;for("boolean"==typeof d.trailingSpace&&d.trailingSpace&&(r=0);n>=i;n--)if(80===e[n])if(e.readUInt32LE(n)!==s.Constants.ENDSIG)if(e.readUInt32LE(n)!==s.Constants.END64SIG){if(e.readUInt32LE(n)===s.Constants.ZIP64SIG){a=n,o=n+s.readBigUInt64LE(e,n+s.Constants.ZIP64SIZE)+s.Constants.ZIP64LEAD;break}}else i=r;else a=n,f=n,o=n+s.Constants.ENDHDR,i=n-s.Constants.END64HDR;if(-1==a)throw s.Errors.INVALID_FORMAT();l.loadFromBinary(e.slice(a,o)),l.commentLength&&(c=e.slice(f+s.Constants.ENDHDR)),t&&m()}(d.readEntries):f=!0,{get entries(){return f||m(),n.filter(e=>!u.has(e))},get comment(){return p.decode(c)},set comment(e){c=s.toBuffer(e,p.encode),l.commentLength=c.length},getEntryCount:function(){return f?n.length:l.diskEntries},forEach:function(e){this.entries.forEach(e)},getEntry:function(e){return f||m(),a[e]||null},setEntry:function(e){f||m(),n.push(e),a[e.entryName]=e,l.totalEntries=n.length},deleteFile:function(e,t=!0){f||m();const n=a[e];this.getEntryChildren(n,t).map(e=>e.entryName).forEach(this.deleteEntry)},deleteEntry:function(e){f||m();const t=a[e],r=n.indexOf(t);r>=0&&(n.splice(r,1),delete a[e],l.totalEntries=n.length)},getEntryChildren:function(e,t=!0){if(f||m(),"object"==typeof e){if(e.isDirectory&&t){const t=[],r=e.entryName;for(const e of n)e.entryName.startsWith(r)&&t.push(e);return t}return[e]}return[]},getChildCount:function(e){if(e&&e.isDirectory){const t=this.getEntryChildren(e);return t.includes(e)?t.length-1:t.length}return 0},compressToBuffer:function(){f||m(),g();const t=[],n=[];let i=0,o=0;l.size=0,l.offset=0;let a=0;for(const e of this.entries){const r=e.getCompressedData();e.header.offset=o;const s=e.packLocalHeader(),c=s.length+r.length;o+=c,t.push(s),t.push(r);const f=e.packCentralHeader();n.push(f),l.size+=f.length,i+=c+f.length,a++}i+=l.mainHeaderSize,l.offset=o,l.totalEntries=a,o=0;const u=r.alloc(i);for(const e of t)e.copy(u,o),o+=e.length;for(const e of n)e.copy(u,o),o+=e.length;const d=l.toBinary();return c&&c.copy(d,s.Constants.ENDHDR),d.copy(u,o),e=u,f=!1,u},toAsyncBuffer:function(t,n,i,o){try{f||m(),g();const n=[],a=[];let u=0,d=0,h=0;l.size=0,l.offset=0;const p=function(m){if(m.length>0){const e=m.shift(),t=e.entryName+e.extra.toString();i&&i(t),e.getCompressedDataAsync(function(r){o&&o(t),e.header.offset=d;const i=e.packLocalHeader(),s=i.length+r.length;d+=s,n.push(i),n.push(r);const c=e.packCentralHeader();a.push(c),l.size+=c.length,u+=s+c.length,h++,p(m)})}else{u+=l.mainHeaderSize,l.offset=d,l.totalEntries=h,d=0;const i=r.alloc(u);n.forEach(function(e){e.copy(i,d),d+=e.length}),a.forEach(function(e){e.copy(i,d),d+=e.length});const o=l.toBinary();c&&c.copy(o,s.Constants.ENDHDR),o.copy(i,d),e=i,f=!1,t(i)}};p(Array.from(this.entries))}catch(e){n(e)}}}}},243:(e,t)=>{const n={INVALID_LOC:"Invalid LOC header (bad signature)",INVALID_CEN:"Invalid CEN header (bad signature)",INVALID_END:"Invalid END header (bad signature)",DESCRIPTOR_NOT_EXIST:"No descriptor present",DESCRIPTOR_UNKNOWN:"Unknown descriptor format",DESCRIPTOR_FAULTY:"Descriptor data is malformed",NO_DATA:"Nothing to decompress",BAD_CRC:"CRC32 checksum failed {0}",FILE_IN_THE_WAY:"There is a file in the way: {0}",UNKNOWN_METHOD:"Invalid/unsupported compression method",AVAIL_DATA:"inflate::Available inflate data did not terminate",INVALID_DISTANCE:"inflate::Invalid literal/length or distance code in fixed or dynamic block",TO_MANY_CODES:"inflate::Dynamic block code description: too many length or distance codes",INVALID_REPEAT_LEN:"inflate::Dynamic block code description: repeat more than specified lengths",INVALID_REPEAT_FIRST:"inflate::Dynamic block code description: repeat lengths with no first length",INCOMPLETE_CODES:"inflate::Dynamic block code description: code lengths codes incomplete",INVALID_DYN_DISTANCE:"inflate::Dynamic block code description: invalid distance code lengths",INVALID_CODES_LEN:"inflate::Dynamic block code description: invalid literal/length code lengths",INVALID_STORE_BLOCK:"inflate::Stored block length did not match one's complement",INVALID_BLOCK_TYPE:"inflate::Invalid block type (type == 3)",CANT_EXTRACT_FILE:"Could not extract the file",CANT_OVERRIDE:"Target file already exists",DISK_ENTRY_TOO_LARGE:"Number of disk entries is too large",NO_ZIP:"No zip file was loaded",NO_ENTRY:"Entry doesn't exist",DIRECTORY_CONTENT_ERROR:"A directory cannot have content",FILE_NOT_FOUND:'File not found: "{0}"',NOT_IMPLEMENTED:"Not implemented",INVALID_FILENAME:"Invalid filename",INVALID_FORMAT:"Invalid or unsupported zip format. No END header found",INVALID_PASS_PARAM:"Incompatible password parameter",WRONG_PASSWORD:"Wrong Password",COMMENT_TOO_LONG:"Comment is too long",EXTRA_FIELD_PARSE_ERROR:"Extra field parsing error"};function r(e){return function(...t){return t.length&&(e=e.replace(/\{(\d)\}/g,(e,n)=>t[n]||"")),new Error("ADM-ZIP: "+e)}}for(const e of Object.keys(n))t[e]=r(n[e])},247:()=>{},251:(e,t)=>{t.read=function(e,t,n,r,i){var o,s,a=8*i-r-1,c=(1<<a)-1,l=c>>1,f=-7,u=n?i-1:0,d=n?-1:1,h=e[t+u];for(u+=d,o=h&(1<<-f)-1,h>>=-f,f+=a;f>0;o=256*o+e[t+u],u+=d,f-=8);for(s=o&(1<<-f)-1,o>>=-f,f+=r;f>0;s=256*s+e[t+u],u+=d,f-=8);if(0===o)o=1-l;else{if(o===c)return s?NaN:1/0*(h?-1:1);s+=Math.pow(2,r),o-=l}return(h?-1:1)*s*Math.pow(2,o-r)},t.write=function(e,t,n,r,i,o){var s,a,c,l=8*o-i-1,f=(1<<l)-1,u=f>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,h=r?0:o-1,p=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=f):(s=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-s))<1&&(s--,c*=2),(t+=s+u>=1?d/c:d*Math.pow(2,1-u))*c>=2&&(s++,c/=2),s+u>=f?(a=0,s=f):s+u>=1?(a=(t*c-1)*Math.pow(2,i),s+=u):(a=t*Math.pow(2,u-1)*Math.pow(2,i),s=0));i>=8;e[n+h]=255&a,h+=p,a/=256,i-=8);for(s=s<<i|a,l+=i;l>0;e[n+h]=255&s,h+=p,s/=256,l-=8);e[n+h-p]|=128*m}},283:(e,t,n)=>{var r=n(287).hp,i=n(606);const o=n(70),s=n(154),a=n(16),c=n(224),l=(...e)=>o.findLast(e,e=>"boolean"==typeof e),f=(...e)=>o.findLast(e,e=>"string"==typeof e),u={noSort:!1,readEntries:!1,method:o.Constants.NONE,fs:null};e.exports=function(e,t){let n=null;const d=Object.assign(Object.create(null),u);e&&"object"==typeof e&&(e instanceof Uint8Array||(Object.assign(d,e),e=d.input?d.input:void 0,d.input&&delete d.input),r.isBuffer(e)&&(n=e,d.method=o.Constants.BUFFER,e=void 0)),Object.assign(d,t);const h=new o(d);if("object"==typeof d.decoder&&"function"==typeof d.decoder.encode&&"function"==typeof d.decoder.decode||(d.decoder=o.decoder),e&&"string"==typeof e){if(!h.fs.existsSync(e))throw o.Errors.INVALID_FILENAME();d.method=o.Constants.FILE,d.filename=e,n=h.fs.readFileSync(e)}const p=new c(n,d),{canonical:m,sanitize:g,zipnamefix:y}=o;function E(e){var t;return e&&p&&("string"==typeof e&&(t=p.getEntry(s.posix.normalize(e))),"object"==typeof e&&void 0!==e.entryName&&void 0!==e.header&&(t=p.getEntry(e.entryName)),t)?t:null}function w(e){const{join:t,normalize:n,sep:r}=s.posix;return t(".",n(r+e.split("\\").join(r)+r))}function I(e){return e instanceof RegExp?(t=e,function(e){return t.test(e)}):"function"!=typeof e?()=>!0:e;var t}const D=(e,t)=>{let n=t.slice(-1);return n=n===h.sep?h.sep:"",s.relative(e,t)+n};return{readFile:function(e,t){var n=E(e);return n&&n.getData(t)||null},childCount:function(e){const t=E(e);if(t)return p.getChildCount(t)},readFileAsync:function(e,t){var n=E(e);n?n.getDataAsync(t):t(null,"getEntry failed for:"+e)},readAsText:function(e,t){var n=E(e);if(n){var r=n.getData();if(r&&r.length)return r.toString(t||"utf8")}return""},readAsTextAsync:function(e,t,n){var r=E(e);r?r.getDataAsync(function(e,r){r?t(e,r):e&&e.length?t(e.toString(n||"utf8")):t("")}):t("")},deleteFile:function(e,t=!0){var n=E(e);n&&p.deleteFile(n.entryName,t)},deleteEntry:function(e){var t=E(e);t&&p.deleteEntry(t.entryName)},addZipComment:function(e){p.comment=e},getZipComment:function(){return p.comment||""},addZipEntryComment:function(e,t){var n=E(e);n&&(n.comment=t)},getZipEntryComment:function(e){var t=E(e);return t&&t.comment||""},updateFile:function(e,t){var n=E(e);n&&n.setData(t)},addLocalFile:function(e,t,n,i){if(!h.fs.existsSync(e))throw o.Errors.FILE_NOT_FOUND(e);{t=t?w(t):"";const o=s.win32.basename(s.win32.normalize(e));t+=n||o;const a=h.fs.statSync(e),c=a.isFile()?h.fs.readFileSync(e):r.alloc(0);a.isDirectory()&&(t+=h.sep),this.addFile(t,c,i,a)}},addLocalFileAsync:function(e,t){e="object"==typeof e?e:{localPath:e};const n=s.resolve(e.localPath),{comment:i}=e;let{zipPath:o,zipName:a}=e;const c=this;h.fs.stat(n,function(e,l){if(e)return t(e,!1);o=o?w(o):"";const f=s.win32.basename(s.win32.normalize(n));if(o+=a||f,l.isFile())h.fs.readFile(n,function(e,n){return e?t(e,!1):(c.addFile(o,n,i,l),setImmediate(t,void 0,!0))});else if(l.isDirectory())return o+=h.sep,c.addFile(o,r.alloc(0),i,l),setImmediate(t,void 0,!0)})},addLocalFolder:function(e,t,n){if(n=I(n),t=t?w(t):"",e=s.normalize(e),!h.fs.existsSync(e))throw o.Errors.FILE_NOT_FOUND(e);{const r=h.findFiles(e),i=this;if(r.length)for(const o of r){const r=s.join(t,D(e,o));n(r)&&i.addLocalFile(o,s.dirname(r))}}},addLocalFolderAsync:function(e,t,n,a){a=I(a),n=n?w(n):"",e=s.normalize(e);var c=this;h.fs.open(e,"r",function(s){if(s&&"ENOENT"===s.code)t(void 0,o.Errors.FILE_NOT_FOUND(e));else if(s)t(void 0,s);else{var l=h.findFiles(e),f=-1,u=function(){if((f+=1)<l.length){var o=l[f],s=D(e,o).split("\\").join("/");s=s.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^\x20-\x7E]/g,""),a(s)?h.fs.stat(o,function(e,i){e&&t(void 0,e),i.isFile()?h.fs.readFile(o,function(e,r){e?t(void 0,e):(c.addFile(n+s,r,"",i),u())}):(c.addFile(n+s+"/",r.alloc(0),"",i),u())}):i.nextTick(()=>{u()})}else t(!0,void 0)};u()}})},addLocalFolderAsync2:function(e,t){const n=this;e="object"==typeof e?e:{localPath:e},localPath=s.resolve(w(e.localPath));let{zipPath:r,filter:i,namefix:a}=e;var c;i instanceof RegExp?(c=i,i=function(e){return c.test(e)}):"function"!=typeof i&&(i=function(){return!0}),r=r?w(r):"","latin1"==a&&(a=e=>e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^\x20-\x7E]/g,"")),"function"!=typeof a&&(a=e=>e);const l=e=>s.join(r,a(D(localPath,e))),f=e=>s.win32.basename(s.win32.normalize(a(e)));h.fs.open(localPath,"r",function(e){e&&"ENOENT"===e.code?t(void 0,o.Errors.FILE_NOT_FOUND(localPath)):e?t(void 0,e):h.findFilesAsync(localPath,function(e,r){if(e)return t(e);(r=r.filter(e=>i(l(e)))).length||t(void 0,!1),setImmediate(r.reverse().reduce(function(e,t){return function(r,i){if(r||!1===i)return setImmediate(e,r,!1);n.addLocalFileAsync({localPath:t,zipPath:s.dirname(l(t)),zipName:f(t)},e)}},t))})})},addLocalFolderPromise:function(e,t){return new Promise((n,r)=>{this.addLocalFolderAsync2(Object.assign({localPath:e},t),(e,t)=>{e&&r(e),t&&n(this)})})},addFile:function(e,t,n,r){let i=E(e=y(e));const o=null!=i;o||(i=new a(d),i.entryName=e),i.comment=n||"";const s="object"==typeof r&&r instanceof h.fs.Stats;s&&(i.header.time=r.mtime);var c=i.isDirectory?16:0;let l=i.isDirectory?16384:32768;return l|=s?4095&r.mode:"number"==typeof r?4095&r:i.isDirectory?493:420,c=(c|l<<16)>>>0,i.attr=c,i.setData(t),o||p.setEntry(i),i},getEntries:function(e){return p.password=e,p?p.entries:[]},getEntry:function(e){return E(e)},getEntryCount:function(){return p.getEntryCount()},forEach:function(e){return p.forEach(e)},extractEntryTo:function(e,t,n,r,i,a){r=l(!1,r),i=l(!1,i),n=l(!0,n),a=f(i,a);var c=E(e);if(!c)throw o.Errors.NO_ENTRY();var u=m(c.entryName),d=g(t,a&&!c.isDirectory?a:n?u:s.basename(u));if(c.isDirectory)return p.getEntryChildren(c).forEach(function(e){if(e.isDirectory)return;var a=e.getData();if(!a)throw o.Errors.CANT_EXTRACT_FILE();var c=m(e.entryName),l=g(t,n?c:s.basename(c));const f=i?e.header.fileAttr:void 0;h.writeFileTo(l,a,r,f)}),!0;var y=c.getData(p.password);if(!y)throw o.Errors.CANT_EXTRACT_FILE();if(h.fs.existsSync(d)&&!r)throw o.Errors.CANT_OVERRIDE();const w=i?e.header.fileAttr:void 0;return h.writeFileTo(d,y,r,w),!0},test:function(e){if(!p)return!1;for(var t in p.entries)try{if(t.isDirectory)continue;if(!p.entries[t].getData(e))return!1}catch(e){return!1}return!0},extractAllTo:function(e,t,n,r){if(n=l(!1,n),r=f(n,r),t=l(!1,t),!p)throw o.Errors.NO_ZIP();p.entries.forEach(function(i){var s=g(e,m(i.entryName));if(i.isDirectory)return void h.makeDir(s);var a=i.getData(r);if(!a)throw o.Errors.CANT_EXTRACT_FILE();const c=n?i.header.fileAttr:void 0;h.writeFileTo(s,a,t,c);try{h.fs.utimesSync(s,i.header.time,i.header.time)}catch(e){throw o.Errors.CANT_EXTRACT_FILE()}})},extractAllToAsync:function(e,t,n,r){if(r=((...e)=>o.findLast(e,e=>"function"==typeof e))(t,n,r),n=l(!1,n),t=l(!1,t),!r)return new Promise((r,i)=>{this.extractAllToAsync(e,t,n,function(e){e?i(e):r(this)})});if(!p)return void r(o.Errors.NO_ZIP());e=s.resolve(e);const i=t=>g(e,s.normalize(m(t.entryName))),a=(e,t)=>new Error(e+': "'+t+'"'),c=[],f=[];p.entries.forEach(e=>{e.isDirectory?c.push(e):f.push(e)});for(const e of c){const t=i(e),o=n?e.header.fileAttr:void 0;try{h.makeDir(t),o&&h.fs.chmodSync(t,o),h.fs.utimesSync(t,e.header.time,e.header.time)}catch(e){r(a("Unable to create folder",t))}}f.reverse().reduce(function(r,i){return function(c){if(c)r(c);else{const c=s.normalize(m(i.entryName)),l=g(e,c);i.getDataAsync(function(e,s){if(s)r(s);else if(e){const o=n?i.header.fileAttr:void 0;h.writeFileToAsync(l,e,t,o,function(e){e||r(a("Unable to write file",l)),h.fs.utimes(l,i.header.time,i.header.time,function(e){e?r(a("Unable to set times",l)):r()})})}else r(o.Errors.CANT_EXTRACT_FILE())})}}},r)()},writeZip:function(e,t){if(1===arguments.length&&"function"==typeof e&&(t=e,e=""),!e&&d.filename&&(e=d.filename),e){var n=p.compressToBuffer();if(n){var r=h.writeFileTo(e,n,!0);"function"==typeof t&&t(r?null:new Error("failed"),"")}}},writeZipPromise:function(e,t){const{overwrite:n,perm:r}=Object.assign({overwrite:!0},t);return new Promise((t,i)=>{!e&&d.filename&&(e=d.filename),e||i("ADM-ZIP: ZIP File Name Missing"),this.toBufferPromise().then(o=>{h.writeFileToAsync(e,o,n,r,e=>e?t(e):i("ADM-ZIP: Wasn't able to write zip file"))},i)})},toBufferPromise:function(){return new Promise((e,t)=>{p.toAsyncBuffer(e,t)})},toBuffer:function(e,t,n,r){return"function"==typeof e?(p.toAsyncBuffer(e,t,n,r),null):p.compressToBuffer()}}}},287:(e,t,n)=>{"use strict";const r=n(526),i=n(251),o="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.hp=c,t.IS=50;const s=2147483647;function a(e){if(e>s)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,c.prototype),t}function c(e,t,n){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return u(e)}return l(e,t,n)}function l(e,t,n){if("string"==typeof e)return function(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!c.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const n=0|m(e,t);let r=a(n);const i=r.write(e,t);return i!==n&&(r=r.slice(0,i)),r}(e,t);if(ArrayBuffer.isView(e))return function(e){if(K(e,Uint8Array)){const t=new Uint8Array(e);return h(t.buffer,t.byteOffset,t.byteLength)}return d(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(K(e,ArrayBuffer)||e&&K(e.buffer,ArrayBuffer))return h(e,t,n);if("undefined"!=typeof SharedArrayBuffer&&(K(e,SharedArrayBuffer)||e&&K(e.buffer,SharedArrayBuffer)))return h(e,t,n);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return c.from(r,t,n);const i=function(e){if(c.isBuffer(e)){const t=0|p(e.length),n=a(t);return 0===n.length||e.copy(n,0,0,t),n}return void 0!==e.length?"number"!=typeof e.length||q(e.length)?a(0):d(e):"Buffer"===e.type&&Array.isArray(e.data)?d(e.data):void 0}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return c.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function f(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function u(e){return f(e),a(e<0?0:0|p(e))}function d(e){const t=e.length<0?0:0|p(e.length),n=a(t);for(let r=0;r<t;r+=1)n[r]=255&e[r];return n}function h(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');let r;return r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),Object.setPrototypeOf(r,c.prototype),r}function p(e){if(e>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return 0|e}function m(e,t){if(c.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||K(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const n=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return G(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return V(e).length;default:if(i)return r?-1:G(e).length;t=(""+t).toLowerCase(),i=!0}}function g(e,t,n){let r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return O(this,t,n);case"utf8":case"utf-8":return v(this,t,n);case"ascii":return x(this,t,n);case"latin1":case"binary":return T(this,t,n);case"base64":return C(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return F(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function y(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function E(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),q(n=+n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=c.from(t,r)),c.isBuffer(t))return 0===t.length?-1:w(e,t,n,r,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):w(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function w(e,t,n,r,i){let o,s=1,a=e.length,c=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;s=2,a/=2,c/=2,n/=2}function l(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i){let r=-1;for(o=n;o<a;o++)if(l(e,o)===l(t,-1===r?0:o-r)){if(-1===r&&(r=o),o-r+1===c)return r*s}else-1!==r&&(o-=o-r),r=-1}else for(n+c>a&&(n=a-c),o=n;o>=0;o--){let n=!0;for(let r=0;r<c;r++)if(l(e,o+r)!==l(t,r)){n=!1;break}if(n)return o}return-1}function I(e,t,n,r){n=Number(n)||0;const i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;const o=t.length;let s;for(r>o/2&&(r=o/2),s=0;s<r;++s){const r=parseInt(t.substr(2*s,2),16);if(q(r))return s;e[n+s]=r}return s}function D(e,t,n,r){return X(G(t,e.length-n),e,n,r)}function b(e,t,n,r){return X(function(e){const t=[];for(let n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function L(e,t,n,r){return X(V(t),e,n,r)}function N(e,t,n,r){return X(function(e,t){let n,r,i;const o=[];for(let s=0;s<e.length&&!((t-=2)<0);++s)n=e.charCodeAt(s),r=n>>8,i=n%256,o.push(i),o.push(r);return o}(t,e.length-n),e,n,r)}function C(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function v(e,t,n){n=Math.min(e.length,n);const r=[];let i=t;for(;i<n;){const t=e[i];let o=null,s=t>239?4:t>223?3:t>191?2:1;if(i+s<=n){let n,r,a,c;switch(s){case 1:t<128&&(o=t);break;case 2:n=e[i+1],128==(192&n)&&(c=(31&t)<<6|63&n,c>127&&(o=c));break;case 3:n=e[i+1],r=e[i+2],128==(192&n)&&128==(192&r)&&(c=(15&t)<<12|(63&n)<<6|63&r,c>2047&&(c<55296||c>57343)&&(o=c));break;case 4:n=e[i+1],r=e[i+2],a=e[i+3],128==(192&n)&&128==(192&r)&&128==(192&a)&&(c=(15&t)<<18|(63&n)<<12|(63&r)<<6|63&a,c>65535&&c<1114112&&(o=c))}}null===o?(o=65533,s=1):o>65535&&(o-=65536,r.push(o>>>10&1023|55296),o=56320|1023&o),r.push(o),i+=s}return function(e){const t=e.length;if(t<=S)return String.fromCharCode.apply(String,e);let n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=S));return n}(r)}c.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),c.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(c.prototype,"parent",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.buffer}}),Object.defineProperty(c.prototype,"offset",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.byteOffset}}),c.poolSize=8192,c.from=function(e,t,n){return l(e,t,n)},Object.setPrototypeOf(c.prototype,Uint8Array.prototype),Object.setPrototypeOf(c,Uint8Array),c.alloc=function(e,t,n){return function(e,t,n){return f(e),e<=0?a(e):void 0!==t?"string"==typeof n?a(e).fill(t,n):a(e).fill(t):a(e)}(e,t,n)},c.allocUnsafe=function(e){return u(e)},c.allocUnsafeSlow=function(e){return u(e)},c.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==c.prototype},c.compare=function(e,t){if(K(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),K(t,Uint8Array)&&(t=c.from(t,t.offset,t.byteLength)),!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let n=e.length,r=t.length;for(let i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);let n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;const r=c.allocUnsafe(t);let i=0;for(n=0;n<e.length;++n){let t=e[n];if(K(t,Uint8Array))i+t.length>r.length?(c.isBuffer(t)||(t=c.from(t)),t.copy(r,i)):Uint8Array.prototype.set.call(r,t,i);else{if(!c.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(r,i)}i+=t.length}return r},c.byteLength=m,c.prototype._isBuffer=!0,c.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)y(this,t,t+1);return this},c.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},c.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},c.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?v(this,0,e):g.apply(this,arguments)},c.prototype.toLocaleString=c.prototype.toString,c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){let e="";const n=t.IS;return e=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(e+=" ... "),"<Buffer "+e+">"},o&&(c.prototype[o]=c.prototype.inspect),c.prototype.compare=function(e,t,n,r,i){if(K(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),!c.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;let o=(i>>>=0)-(r>>>=0),s=(n>>>=0)-(t>>>=0);const a=Math.min(o,s),l=this.slice(r,i),f=e.slice(t,n);for(let e=0;e<a;++e)if(l[e]!==f[e]){o=l[e],s=f[e];break}return o<s?-1:s<o?1:0},c.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},c.prototype.indexOf=function(e,t,n){return E(this,e,t,n,!0)},c.prototype.lastIndexOf=function(e,t,n){return E(this,e,t,n,!1)},c.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}const i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");let o=!1;for(;;)switch(r){case"hex":return I(this,e,t,n);case"utf8":case"utf-8":return D(this,e,t,n);case"ascii":case"latin1":case"binary":return b(this,e,t,n);case"base64":return L(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return N(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const S=4096;function x(e,t,n){let r="";n=Math.min(e.length,n);for(let i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function T(e,t,n){let r="";n=Math.min(e.length,n);for(let i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function O(e,t,n){const r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);let i="";for(let r=t;r<n;++r)i+=Y[e[r]];return i}function F(e,t,n){const r=e.slice(t,n);let i="";for(let e=0;e<r.length-1;e+=2)i+=String.fromCharCode(r[e]+256*r[e+1]);return i}function A(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function R(e,t,n,r,i,o){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function _(e,t,n,r,i){H(t,r,i,e,n,7);let o=Number(t&BigInt(4294967295));e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o;let s=Number(t>>BigInt(32)&BigInt(4294967295));return e[n++]=s,s>>=8,e[n++]=s,s>>=8,e[n++]=s,s>>=8,e[n++]=s,n}function U(e,t,n,r,i){H(t,r,i,e,n,7);let o=Number(t&BigInt(4294967295));e[n+7]=o,o>>=8,e[n+6]=o,o>>=8,e[n+5]=o,o>>=8,e[n+4]=o;let s=Number(t>>BigInt(32)&BigInt(4294967295));return e[n+3]=s,s>>=8,e[n+2]=s,s>>=8,e[n+1]=s,s>>=8,e[n]=s,n+8}function B(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function P(e,t,n,r,o){return t=+t,n>>>=0,o||B(e,0,n,4),i.write(e,t,n,r,23,4),n+4}function M(e,t,n,r,o){return t=+t,n>>>=0,o||B(e,0,n,8),i.write(e,t,n,r,52,8),n+8}c.prototype.slice=function(e,t){const n=this.length;(e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);const r=this.subarray(e,t);return Object.setPrototypeOf(r,c.prototype),r},c.prototype.readUintLE=c.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||A(e,t,this.length);let r=this[e],i=1,o=0;for(;++o<t&&(i*=256);)r+=this[e+o]*i;return r},c.prototype.readUintBE=c.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||A(e,t,this.length);let r=this[e+--t],i=1;for(;t>0&&(i*=256);)r+=this[e+--t]*i;return r},c.prototype.readUint8=c.prototype.readUInt8=function(e,t){return e>>>=0,t||A(e,1,this.length),this[e]},c.prototype.readUint16LE=c.prototype.readUInt16LE=function(e,t){return e>>>=0,t||A(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUint16BE=c.prototype.readUInt16BE=function(e,t){return e>>>=0,t||A(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUint32LE=c.prototype.readUInt32LE=function(e,t){return e>>>=0,t||A(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUint32BE=c.prototype.readUInt32BE=function(e,t){return e>>>=0,t||A(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readBigUInt64LE=J(function(e){Z(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||$(e,this.length-8);const r=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,i=this[++e]+256*this[++e]+65536*this[++e]+n*2**24;return BigInt(r)+(BigInt(i)<<BigInt(32))}),c.prototype.readBigUInt64BE=J(function(e){Z(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||$(e,this.length-8);const r=t*2**24+65536*this[++e]+256*this[++e]+this[++e],i=this[++e]*2**24+65536*this[++e]+256*this[++e]+n;return(BigInt(r)<<BigInt(32))+BigInt(i)}),c.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||A(e,t,this.length);let r=this[e],i=1,o=0;for(;++o<t&&(i*=256);)r+=this[e+o]*i;return i*=128,r>=i&&(r-=Math.pow(2,8*t)),r},c.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||A(e,t,this.length);let r=t,i=1,o=this[e+--r];for(;r>0&&(i*=256);)o+=this[e+--r]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*t)),o},c.prototype.readInt8=function(e,t){return e>>>=0,t||A(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){e>>>=0,t||A(e,2,this.length);const n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(e,t){e>>>=0,t||A(e,2,this.length);const n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(e,t){return e>>>=0,t||A(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return e>>>=0,t||A(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readBigInt64LE=J(function(e){Z(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||$(e,this.length-8);const r=this[e+4]+256*this[e+5]+65536*this[e+6]+(n<<24);return(BigInt(r)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)}),c.prototype.readBigInt64BE=J(function(e){Z(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||$(e,this.length-8);const r=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(r)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+n)}),c.prototype.readFloatLE=function(e,t){return e>>>=0,t||A(e,4,this.length),i.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return e>>>=0,t||A(e,4,this.length),i.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return e>>>=0,t||A(e,8,this.length),i.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return e>>>=0,t||A(e,8,this.length),i.read(this,e,!1,52,8)},c.prototype.writeUintLE=c.prototype.writeUIntLE=function(e,t,n,r){e=+e,t>>>=0,n>>>=0,r||R(this,e,t,n,Math.pow(2,8*n)-1,0);let i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},c.prototype.writeUintBE=c.prototype.writeUIntBE=function(e,t,n,r){e=+e,t>>>=0,n>>>=0,r||R(this,e,t,n,Math.pow(2,8*n)-1,0);let i=n-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+n},c.prototype.writeUint8=c.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,1,255,0),this[t]=255&e,t+1},c.prototype.writeUint16LE=c.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},c.prototype.writeUint16BE=c.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},c.prototype.writeUint32LE=c.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},c.prototype.writeUint32BE=c.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},c.prototype.writeBigUInt64LE=J(function(e,t=0){return _(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),c.prototype.writeBigUInt64BE=J(function(e,t=0){return U(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),c.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t>>>=0,!r){const r=Math.pow(2,8*n-1);R(this,e,t,n,r-1,-r)}let i=0,o=1,s=0;for(this[t]=255&e;++i<n&&(o*=256);)e<0&&0===s&&0!==this[t+i-1]&&(s=1),this[t+i]=(e/o|0)-s&255;return t+n},c.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t>>>=0,!r){const r=Math.pow(2,8*n-1);R(this,e,t,n,r-1,-r)}let i=n-1,o=1,s=0;for(this[t+i]=255&e;--i>=0&&(o*=256);)e<0&&0===s&&0!==this[t+i+1]&&(s=1),this[t+i]=(e/o|0)-s&255;return t+n},c.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},c.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},c.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},c.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},c.prototype.writeBigInt64LE=J(function(e,t=0){return _(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),c.prototype.writeBigInt64BE=J(function(e,t=0){return U(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),c.prototype.writeFloatLE=function(e,t,n){return P(this,e,t,!0,n)},c.prototype.writeFloatBE=function(e,t,n){return P(this,e,t,!1,n)},c.prototype.writeDoubleLE=function(e,t,n){return M(this,e,t,!0,n)},c.prototype.writeDoubleBE=function(e,t,n){return M(this,e,t,!1,n)},c.prototype.copy=function(e,t,n,r){if(!c.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);const i=r-n;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,n,r):Uint8Array.prototype.set.call(e,this.subarray(n,r),t),i},c.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!c.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===e.length){const t=e.charCodeAt(0);("utf8"===r&&t<128||"latin1"===r)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;let i;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(i=t;i<n;++i)this[i]=e;else{const o=c.isBuffer(e)?e:c.from(e,r),s=o.length;if(0===s)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<n-t;++i)this[i+t]=o[i%s]}return this};const z={};function k(e,t,n){z[e]=class extends n{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function j(e){let t="",n=e.length;const r="-"===e[0]?1:0;for(;n>=r+4;n-=3)t=`_${e.slice(n-3,n)}${t}`;return`${e.slice(0,n)}${t}`}function H(e,t,n,r,i,o){if(e>n||e<t){const r="bigint"==typeof t?"n":"";let i;throw i=o>3?0===t||t===BigInt(0)?`>= 0${r} and < 2${r} ** ${8*(o+1)}${r}`:`>= -(2${r} ** ${8*(o+1)-1}${r}) and < 2 ** ${8*(o+1)-1}${r}`:`>= ${t}${r} and <= ${n}${r}`,new z.ERR_OUT_OF_RANGE("value",i,e)}!function(e,t,n){Z(t,"offset"),void 0!==e[t]&&void 0!==e[t+n]||$(t,e.length-(n+1))}(r,i,o)}function Z(e,t){if("number"!=typeof e)throw new z.ERR_INVALID_ARG_TYPE(t,"number",e)}function $(e,t,n){if(Math.floor(e)!==e)throw Z(e,n),new z.ERR_OUT_OF_RANGE(n||"offset","an integer",e);if(t<0)throw new z.ERR_BUFFER_OUT_OF_BOUNDS;throw new z.ERR_OUT_OF_RANGE(n||"offset",`>= ${n?1:0} and <= ${t}`,e)}k("ERR_BUFFER_OUT_OF_BOUNDS",function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),k("ERR_INVALID_ARG_TYPE",function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`},TypeError),k("ERR_OUT_OF_RANGE",function(e,t,n){let r=`The value of "${e}" is out of range.`,i=n;return Number.isInteger(n)&&Math.abs(n)>2**32?i=j(String(n)):"bigint"==typeof n&&(i=String(n),(n>BigInt(2)**BigInt(32)||n<-(BigInt(2)**BigInt(32)))&&(i=j(i)),i+="n"),r+=` It must be ${t}. Received ${i}`,r},RangeError);const W=/[^+/0-9A-Za-z-_]/g;function G(e,t){let n;t=t||1/0;const r=e.length;let i=null;const o=[];for(let s=0;s<r;++s){if(n=e.charCodeAt(s),n>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function V(e){return r.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(W,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function X(e,t,n,r){let i;for(i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}function K(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function q(e){return e!=e}const Y=function(){const e="0123456789abcdef",t=new Array(256);for(let n=0;n<16;++n){const r=16*n;for(let i=0;i<16;++i)t[r+i]=e[n]+e[i]}return t}();function J(e){return"undefined"==typeof BigInt?Q:e}function Q(){throw new Error("BigInt not supported")}},383:e=>{e.exports={LOCHDR:30,LOCSIG:67324752,LOCVER:4,LOCFLG:6,LOCHOW:8,LOCTIM:10,LOCCRC:14,LOCSIZ:18,LOCLEN:22,LOCNAM:26,LOCEXT:28,EXTSIG:134695760,EXTHDR:16,EXTCRC:4,EXTSIZ:8,EXTLEN:12,CENHDR:46,CENSIG:33639248,CENVEM:4,CENVER:6,CENFLG:8,CENHOW:10,CENTIM:12,CENCRC:16,CENSIZ:20,CENLEN:24,CENNAM:28,CENEXT:30,CENCOM:32,CENDSK:34,CENATT:36,CENATX:38,CENOFF:42,ENDHDR:22,ENDSIG:101010256,ENDSUB:8,ENDTOT:10,ENDSIZ:12,ENDOFF:16,ENDCOM:20,END64HDR:20,END64SIG:117853008,END64START:4,END64OFF:8,END64NUMDISKS:16,ZIP64SIG:101075792,ZIP64HDR:56,ZIP64LEAD:12,ZIP64SIZE:4,ZIP64VEM:12,ZIP64VER:14,ZIP64DSK:16,ZIP64DSKDIR:20,ZIP64SUB:24,ZIP64TOT:32,ZIP64SIZB:40,ZIP64OFF:48,ZIP64EXTRA:56,STORED:0,SHRUNK:1,REDUCED1:2,REDUCED2:3,REDUCED3:4,REDUCED4:5,IMPLODED:6,DEFLATED:8,ENHANCED_DEFLATED:9,PKWARE:10,BZIP2:12,LZMA:14,IBM_TERSE:18,IBM_LZ77:19,AES_ENCRYPT:99,FLG_ENC:1,FLG_COMP1:2,FLG_COMP2:4,FLG_DESC:8,FLG_ENH:16,FLG_PATCH:32,FLG_STR:64,FLG_EFS:2048,FLG_MSK:4096,FILE:2,BUFFER:1,NONE:0,EF_ID:0,EF_SIZE:2,ID_ZIP64:1,ID_AVINFO:7,ID_PFS:8,ID_OS2:9,ID_NTFS:10,ID_OPENVMS:12,ID_UNIX:13,ID_FORK:14,ID_PATCH:15,ID_X509_PKCS7:20,ID_X509_CERTID_F:21,ID_X509_CERTID_C:22,ID_STRONGENC:23,ID_RECORD_MGT:24,ID_X509_PKCS7_RL:25,ID_IBM1:101,ID_IBM2:102,ID_POSZIP:18064,EF_ZIP64_OR_32:4294967295,EF_ZIP64_OR_16:65535,EF_ZIP64_SUNCOMP:0,EF_ZIP64_SCOMP:8,EF_ZIP64_RHO:16,EF_ZIP64_DSN:24}},489:(e,t,n)=>{const r="undefined"==typeof window&&void 0!==n.g;e.exports={fetchTemplate:async function(e,t={}){return r?async function(e,t){if(e.startsWith("http://")||e.startsWith("https://")||e.startsWith("file://")){const r=n(92),i=await r(e,t);if(!i.ok)throw new Error(`Failed to fetch template: ${i.status} ${i.statusText}`);return await i.buffer()}{const t=n(497).promises,r=n(61).resolve(e);return await t.readFile(r)}}(e,t):async function(e,t){if(!e.startsWith("http://")&&!e.startsWith("https://")&&!e.startsWith("blob:"))throw new Error("Browser environment requires HTTP(S) URLs or Blob URLs");const n=await fetch(e,t);if(!n.ok)throw new Error(`Failed to fetch template: ${n.status} ${n.statusText}`);return await n.arrayBuffer()}(e,t)},detectMimeType:function(e){return{docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}[e.split(".").pop().toLowerCase()]||"application/octet-stream"},detectDocumentType:function(e){const t=e.split(".").pop().toLowerCase();return["docx","pptx","xlsx"].includes(t)?t:"unknown"},extractFilename:function(e){const t=e.split("?")[0].split("#")[0].split(/[/\\]/);return t[t.length-1]||"template.docx"}}},497:()=>{},526:(e,t)=>{"use strict";t.byteLength=function(e){var t=a(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,o=a(e),s=o[0],c=o[1],l=new i(function(e,t,n){return 3*(t+n)/4-n}(0,s,c)),f=0,u=c>0?s-4:s;for(n=0;n<u;n+=4)t=r[e.charCodeAt(n)]<<18|r[e.charCodeAt(n+1)]<<12|r[e.charCodeAt(n+2)]<<6|r[e.charCodeAt(n+3)],l[f++]=t>>16&255,l[f++]=t>>8&255,l[f++]=255&t;return 2===c&&(t=r[e.charCodeAt(n)]<<2|r[e.charCodeAt(n+1)]>>4,l[f++]=255&t),1===c&&(t=r[e.charCodeAt(n)]<<10|r[e.charCodeAt(n+1)]<<4|r[e.charCodeAt(n+2)]>>2,l[f++]=t>>8&255,l[f++]=255&t),l},t.fromByteArray=function(e){for(var t,r=e.length,i=r%3,o=[],s=16383,a=0,c=r-i;a<c;a+=s)o.push(l(e,a,a+s>c?c:a+s));return 1===i?(t=e[r-1],o.push(n[t>>2]+n[t<<4&63]+"==")):2===i&&(t=(e[r-2]<<8)+e[r-1],o.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"=")),o.join("")};for(var n=[],r=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0;s<64;++s)n[s]=o[s],r[o.charCodeAt(s)]=s;function a(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function c(e){return n[e>>18&63]+n[e>>12&63]+n[e>>6&63]+n[63&e]}function l(e,t,n){for(var r,i=[],o=t;o<n;o+=3)r=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),i.push(c(r));return i.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},527:(e,t,n)=>{var r=n(606),i=n(287).hp;const o=n(629),s=n(673),a=n(383),c=n(243),l="object"==typeof r&&"win32"===r.platform,f=e=>"object"==typeof e&&null!==e,u=new Uint32Array(256).map((e,t)=>{for(let e=0;e<8;e++)1&t?t=3988292384^t>>>1:t>>>=1;return t>>>0});function d(e){this.sep=s.sep,this.fs=o,f(e)&&f(e.fs)&&"function"==typeof e.fs.statSync&&(this.fs=e.fs)}e.exports=d,d.prototype.makeDir=function(e){const t=this;!function(e){let n=e.split(t.sep)[0];e.split(t.sep).forEach(function(e){if(e&&":"!==e.substr(-1,1)){var r;n+=t.sep+e;try{r=t.fs.statSync(n)}catch(e){t.fs.mkdirSync(n)}if(r&&r.isFile())throw c.FILE_IN_THE_WAY(`"${n}"`)}})}(e)},d.prototype.writeFileTo=function(e,t,n,r){const i=this;if(i.fs.existsSync(e)){if(!n)return!1;if(i.fs.statSync(e).isDirectory())return!1}var o,a=s.dirname(e);i.fs.existsSync(a)||i.makeDir(a);try{o=i.fs.openSync(e,"w",438)}catch(t){i.fs.chmodSync(e,438),o=i.fs.openSync(e,"w",438)}if(o)try{i.fs.writeSync(o,t,0,t.length,0)}finally{i.fs.closeSync(o)}return i.fs.chmodSync(e,r||438),!0},d.prototype.writeFileToAsync=function(e,t,n,r,i){"function"==typeof r&&(i=r,r=void 0);const o=this;o.fs.exists(e,function(a){if(a&&!n)return i(!1);o.fs.stat(e,function(n,c){if(a&&c.isDirectory())return i(!1);var l=s.dirname(e);o.fs.exists(l,function(n){n||o.makeDir(l),o.fs.open(e,"w",438,function(n,s){n?o.fs.chmod(e,438,function(){o.fs.open(e,"w",438,function(n,s){o.fs.write(s,t,0,t.length,0,function(){o.fs.close(s,function(){o.fs.chmod(e,r||438,function(){i(!0)})})})})}):s?o.fs.write(s,t,0,t.length,0,function(){o.fs.close(s,function(){o.fs.chmod(e,r||438,function(){i(!0)})})}):o.fs.chmod(e,r||438,function(){i(!0)})})})})})},d.prototype.findFiles=function(e){const t=this;return function e(n,r,i){"boolean"==typeof r&&(i=r,r=void 0);let o=[];return t.fs.readdirSync(n).forEach(function(a){const c=s.join(n,a),l=t.fs.statSync(c);r&&!r.test(c)||o.push(s.normalize(c)+(l.isDirectory()?t.sep:"")),l.isDirectory()&&i&&(o=o.concat(e(c,r,i)))}),o}(e,void 0,!0)},d.prototype.findFilesAsync=function(e,t){const n=this;let r=[];n.fs.readdir(e,function(i,o){if(i)return t(i);let a=o.length;if(!a)return t(null,r);o.forEach(function(i){i=s.join(e,i),n.fs.stat(i,function(e,o){if(e)return t(e);o&&(r.push(s.normalize(i)+(o.isDirectory()?n.sep:"")),o.isDirectory()?n.findFilesAsync(i,function(e,n){if(e)return t(e);r=r.concat(n),--a||t(null,r)}):--a||t(null,r))})})})},d.prototype.getAttributes=function(){},d.prototype.setAttributes=function(){},d.crc32update=function(e,t){return u[255&(e^t)]^e>>>8},d.crc32=function(e){"string"==typeof e&&(e=i.from(e,"utf8"));let t=e.length,n=-1;for(let r=0;r<t;)n=d.crc32update(n,e[r++]);return~n>>>0},d.methodToString=function(e){switch(e){case a.STORED:return"STORED ("+e+")";case a.DEFLATED:return"DEFLATED ("+e+")";default:return"UNSUPPORTED ("+e+")"}},d.canonical=function(e){if(!e)return"";const t=s.posix.normalize("/"+e.split("\\").join("/"));return s.join(".",t)},d.zipnamefix=function(e){if(!e)return"";const t=s.posix.normalize("/"+e.split("\\").join("/"));return s.posix.join(".",t)},d.findLast=function(e,t){if(!Array.isArray(e))throw new TypeError("arr is not array");for(let n=(e.length>>>0)-1;n>=0;n--)if(t(e[n],n,e))return e[n]},d.sanitize=function(e,t){e=s.resolve(s.normalize(e));for(var n=t.split("/"),r=0,i=n.length;r<i;r++){var o=s.normalize(s.join(e,n.slice(r,i).join(s.sep)));if(0===o.indexOf(e))return o}return s.normalize(s.join(e,s.basename(t)))},d.toBuffer=function(e,t){return i.isBuffer(e)?e:e instanceof Uint8Array?i.from(e):"string"==typeof e?t(e):i.alloc(0)},d.readBigUInt64LE=function(e,t){var n=i.from(e.slice(t,t+8));return n.swap64(),parseInt(`0x${n.toString("hex")}`)},d.fromDOS2Date=function(e){return new Date(1980+(e>>25&127),Math.max((e>>21&15)-1,0),Math.max(e>>16&31,1),e>>11&31,e>>5&63,(31&e)<<1)},d.fromDate2DOS=function(e){let t=0,n=0;return e.getFullYear()>1979&&(t=(e.getFullYear()-1980&127)<<9|e.getMonth()+1<<5|e.getDate(),n=e.getHours()<<11|e.getMinutes()<<5|e.getSeconds()>>1),t<<16|n},d.isWin=l,d.crcTable=u},573:e=>{e.exports=class{constructor(){this.patterns={standard:/\(\(\(([^)]+)\)\)\)/g,numeric:/\(\(\((\d+)=([^)]+)\)\)\)/g,deleteDirective:/\(\(\((Delete\w+IfEmpty)=([^)]+)\)\)\)/g,any:/\(\(\([^)]+\)\)\)/g},this.cache=new Map}parseDocument(e,t){const n=this.generateCacheKey(t);if(this.cache.has(n))return this.cache.get(n);const r={placeholders:[],uniquePlaceholders:new Set,numericDirectives:[],deleteDirectives:[],fileMap:new Map,summary:{totalPlaceholders:0,uniqueCount:0,filesWithPlaceholders:0,numericDirectiveCount:0,deleteDirectiveCount:0}};for(const e of t){const t=this.parseXmlFile(e);t.length>0&&(r.fileMap.set(e.path,t),r.placeholders.push(...t),r.summary.filesWithPlaceholders++,t.forEach(e=>{r.uniquePlaceholders.add(e.cleanName)}))}return r.numericDirectives=r.placeholders.filter(e=>"numeric"===e.type),r.deleteDirectives=r.placeholders.filter(e=>"delete"===e.type),r.summary.totalPlaceholders=r.placeholders.length,r.summary.uniqueCount=r.uniquePlaceholders.size,r.summary.numericDirectiveCount=r.numericDirectives.length,r.summary.deleteDirectiveCount=r.deleteDirectives.length,r.uniquePlaceholderList=Array.from(r.uniquePlaceholders),this.cache.set(n,r),r}parseXmlFile(e){const t=[],n=e.content||"";if(!n.trim())return t;const r=this.findAllPlaceholders(n);for(const n of r){const r=this.createPlaceholderObject(n,e);t.push(r)}return t}findAllPlaceholders(e){const t=[],n=new Set;let r;for(;null!==(r=this.patterns.numeric.exec(e));){const e=`${r.index}-${r.index+r[0].length}`;n.add(e),t.push({type:"numeric",fullMatch:r[0],numericValue:r[1],content:r[2],index:r.index,length:r[0].length})}for(this.patterns.numeric.lastIndex=0;null!==(r=this.patterns.deleteDirective.exec(e));){const e=`${r.index}-${r.index+r[0].length}`;n.has(e)||(n.add(e),t.push({type:"delete",fullMatch:r[0],directive:r[1],content:r[2],index:r.index,length:r[0].length}))}for(this.patterns.deleteDirective.lastIndex=0;null!==(r=this.patterns.standard.exec(e));){const e=`${r.index}-${r.index+r[0].length}`;n.has(e)||(n.add(e),t.push({type:"standard",fullMatch:r[0],content:r[1],index:r.index,length:r[0].length}))}return this.patterns.standard.lastIndex=0,t.sort((e,t)=>e.index-t.index)}createPlaceholderObject(e,t){const n={type:e.type,rawPattern:e.fullMatch,cleanName:e.content,position:{file:t.path,fileType:t.type,fileCategory:t.category,index:e.index,length:e.length},context:this.extractContext(t.content,e.index,e.length)};return"numeric"===e.type?(n.numericValue=parseInt(e.numericValue,10),n.originalNumber=e.numericValue):"delete"===e.type&&(n.directive=e.directive,n.deleteType=this.getDeleteType(e.directive)),n}extractContext(e,t,n,r=100){const i=Math.max(0,t-r),o=Math.min(e.length,t+n+r);return{before:e.slice(i,t),placeholder:e.slice(t,t+n),after:e.slice(t+n,o),fullContext:e.slice(i,o)}}getDeleteType(e){const t=e.toLowerCase();return t.includes("page")?"page":t.includes("slide")?"slide":t.includes("row")?"row":t.includes("section")?"section":"unknown"}generateCacheKey(e){const t=[...e].sort((e,t)=>e.path.localeCompare(t.path)),n=t.map(e=>e.path),r=t.map(e=>this.simpleHash(e.content||""));return`${n.join("|")}:${r.join("|")}`}simpleHash(e){let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t&=t;return t}getUniquePlaceholders(e){return e.uniquePlaceholderList||[]}getNumericDirectives(e){return e.numericDirectives||[]}getDeleteDirectives(e){return e.deleteDirectives||[]}clearCache(){this.cache.clear()}isValidPlaceholderName(e){if(!e||"string"!=typeof e)return!1;const t=e.trim();return t.length>0&&t.length<=200}parsePlaceholderName(e){return this.isValidPlaceholderName(e)?e.trim().split(".").filter(Boolean):[]}}},593:(e,t,n)=>{var r=n(287).hp,i=n(70),o=i.Constants;e.exports=function(){var e=20,t=10,n=0,s=0,a=0,c=0,l=0,f=0,u=0,d=0,h=0,p=0,m=0,g=0,y=0;e|=i.isWin?2560:768,n|=o.FLG_EFS;const E={extraLen:0},w=e=>Math.max(0,e)>>>0;return a=i.fromDate2DOS(new Date),{get made(){return e},set made(t){e=t},get version(){return t},set version(e){t=e},get flags(){return n},set flags(e){n=e},get flags_efs(){return(n&o.FLG_EFS)>0},set flags_efs(e){e?n|=o.FLG_EFS:n&=~o.FLG_EFS},get flags_desc(){return(n&o.FLG_DESC)>0},set flags_desc(e){e?n|=o.FLG_DESC:n&=~o.FLG_DESC},get method(){return s},set method(e){switch(e){case o.STORED:this.version=10;case o.DEFLATED:default:this.version=20}s=e},get time(){return i.fromDOS2Date(this.timeval)},set time(e){this.timeval=i.fromDate2DOS(e)},get timeval(){return a},set timeval(e){a=w(e)},get timeHighByte(){return e=a>>>8,255&Math.max(0,e);var e},get crc(){return c},set crc(e){c=w(e)},get compressedSize(){return l},set compressedSize(e){l=w(e)},get size(){return f},set size(e){f=w(e)},get fileNameLength(){return u},set fileNameLength(e){u=e},get extraLength(){return d},set extraLength(e){d=e},get extraLocalLength(){return E.extraLen},set extraLocalLength(e){E.extraLen=e},get commentLength(){return h},set commentLength(e){h=e},get diskNumStart(){return p},set diskNumStart(e){p=w(e)},get inAttr(){return m},set inAttr(e){m=w(e)},get attr(){return g},set attr(e){g=w(e)},get fileAttr(){return(g||0)>>16&4095},get offset(){return y},set offset(e){y=w(e)},get encrypted(){return(n&o.FLG_ENC)===o.FLG_ENC},get centralHeaderSize(){return o.CENHDR+u+d+h},get realDataOffset(){return y+o.LOCHDR+E.fnameLen+E.extraLen},get localHeader(){return E},loadLocalHeaderFromBinary:function(e){var t=e.slice(y,y+o.LOCHDR);if(t.readUInt32LE(0)!==o.LOCSIG)throw i.Errors.INVALID_LOC();E.version=t.readUInt16LE(o.LOCVER),E.flags=t.readUInt16LE(o.LOCFLG),E.method=t.readUInt16LE(o.LOCHOW),E.time=t.readUInt32LE(o.LOCTIM),E.crc=t.readUInt32LE(o.LOCCRC),E.compressedSize=t.readUInt32LE(o.LOCSIZ),E.size=t.readUInt32LE(o.LOCLEN),E.fnameLen=t.readUInt16LE(o.LOCNAM),E.extraLen=t.readUInt16LE(o.LOCEXT);const n=y+o.LOCHDR+E.fnameLen,r=n+E.extraLen;return e.slice(n,r)},loadFromBinary:function(r){if(r.length!==o.CENHDR||r.readUInt32LE(0)!==o.CENSIG)throw i.Errors.INVALID_CEN();e=r.readUInt16LE(o.CENVEM),t=r.readUInt16LE(o.CENVER),n=r.readUInt16LE(o.CENFLG),s=r.readUInt16LE(o.CENHOW),a=r.readUInt32LE(o.CENTIM),c=r.readUInt32LE(o.CENCRC),l=r.readUInt32LE(o.CENSIZ),f=r.readUInt32LE(o.CENLEN),u=r.readUInt16LE(o.CENNAM),d=r.readUInt16LE(o.CENEXT),h=r.readUInt16LE(o.CENCOM),p=r.readUInt16LE(o.CENDSK),m=r.readUInt16LE(o.CENATT),g=r.readUInt32LE(o.CENATX),y=r.readUInt32LE(o.CENOFF)},localHeaderToBinary:function(){var e=r.alloc(o.LOCHDR);return e.writeUInt32LE(o.LOCSIG,0),e.writeUInt16LE(t,o.LOCVER),e.writeUInt16LE(n,o.LOCFLG),e.writeUInt16LE(s,o.LOCHOW),e.writeUInt32LE(a,o.LOCTIM),e.writeUInt32LE(c,o.LOCCRC),e.writeUInt32LE(l,o.LOCSIZ),e.writeUInt32LE(f,o.LOCLEN),e.writeUInt16LE(u,o.LOCNAM),e.writeUInt16LE(E.extraLen,o.LOCEXT),e},centralHeaderToBinary:function(){var i=r.alloc(o.CENHDR+u+d+h);return i.writeUInt32LE(o.CENSIG,0),i.writeUInt16LE(e,o.CENVEM),i.writeUInt16LE(t,o.CENVER),i.writeUInt16LE(n,o.CENFLG),i.writeUInt16LE(s,o.CENHOW),i.writeUInt32LE(a,o.CENTIM),i.writeUInt32LE(c,o.CENCRC),i.writeUInt32LE(l,o.CENSIZ),i.writeUInt32LE(f,o.CENLEN),i.writeUInt16LE(u,o.CENNAM),i.writeUInt16LE(d,o.CENEXT),i.writeUInt16LE(h,o.CENCOM),i.writeUInt16LE(p,o.CENDSK),i.writeUInt16LE(m,o.CENATT),i.writeUInt32LE(g,o.CENATX),i.writeUInt32LE(y,o.CENOFF),i},toJSON:function(){const r=function(e){return e+" bytes"};return{made:e,version:t,flags:n,method:i.methodToString(s),time:this.time,crc:"0x"+c.toString(16).toUpperCase(),compressedSize:r(l),size:r(f),fileNameLength:r(u),extraLength:r(d),commentLength:r(h),diskNumStart:p,inAttr:m,attr:g,offset:y,centralHeaderSize:r(o.CENHDR+u+d+h)}},toString:function(){return JSON.stringify(this.toJSON(),null,"\t")}}}},599:(e,t,n)=>{const r=n(36);e.exports=class{constructor(){this.stats={totalSubstitutions:0,successfulSubstitutions:0,failedSubstitutions:0,deletedElements:0},this.options={strictMode:!1,preserveUnmatched:!0,logMissingData:!0,deleteEmptyElements:!0},this.contentDeletion=new r}substituteDocument(e,t,n,r={}){this.resetStats(),this.options={...this.options,...r};const i=new Map,o=new Set;if(!(e.fileMap&&e.fileMap instanceof Map))return{modifiedFiles:i,stats:{...this.stats},deletionCandidates:[],success:!0};for(const[r,s]of e.fileMap){const e=n.find(e=>e.path===r);if(!e)continue;let a=e.content;const c=[...s].sort((e,t)=>t.position.index-e.position.index);for(const e of c){const n=this.substitutePlaceholder(e,t,a);a=n.content,n.shouldDelete&&o.add(r)}i.set(r,{...e,content:a,modified:a!==e.content})}return e.numericDirectives&&e.numericDirectives.length>0&&this.processNumericDirectivesGlobal(e.numericDirectives,t,n,i),this.options.deleteEmptyElements&&this.processDeleteDirectives(e.deleteDirectives,t,i,o),{modifiedFiles:i,stats:{...this.stats},deletionCandidates:Array.from(o),success:0===this.stats.failedSubstitutions||!this.options.strictMode}}processNumericDirectivesGlobal(e,t,n,r){for(const i of e){const e=i.numericValue,o=this.getDataValue(t,i.cleanName);if(null!=o)for(const t of n){const n=r.has(t.path)?r.get(t.path).content:t.content;if(!n)continue;const i=new RegExp(`<v>${e}</v>`,"g");if(i.test(n)){const e=n.replace(i,`<v>${o}</v>`);r.set(t.path,{...t,content:e,modified:!0}),this.stats.successfulSubstitutions++}}}}substitutePlaceholder(e,t,n){this.stats.totalSubstitutions++;try{let r,i=!1;if("delete"===e.type){const n=this.processDeleteDirective(e,t);r=n.replacement,i=n.shouldDelete}else r=this.getDataValue(t,e.cleanName);if(null==r)return this.handleMissingData(e,n);"numeric"===e.type&&(r=this.processNumericDirective(e,r));const o=this.replaceInContent(n,e.position.index,e.position.length,String(r));return this.stats.successfulSubstitutions++,{content:o,shouldDelete:i,success:!0}}catch(t){if(this.stats.failedSubstitutions++,this.options.strictMode)throw new Error(`Substitution failed for ${e.cleanName}: ${t.message}`);return{content:n,shouldDelete:!1,success:!1,error:t.message}}}processDeleteDirective(e,t){const n=this.getDataValue(t,e.cleanName);return this.isEmptyValue(n)?(this.stats.deletedElements++,{replacement:"",shouldDelete:!0}):{replacement:n||"",shouldDelete:!1}}processNumericDirective(e,t){const n=parseFloat(t);return isNaN(n)?(this.options.logMissingData&&console.warn(`Non-numeric value for chart placeholder ${e.cleanName}: ${t}`),e.numericValue):n}handleMissingData(e,t){if(this.stats.failedSubstitutions++,this.options.logMissingData&&console.warn(`Missing data for placeholder: ${e.cleanName}`),this.options.strictMode)throw new Error(`Missing data for required placeholder: ${e.cleanName}`);return this.options.preserveUnmatched?{content:t,shouldDelete:!1,success:!1}:{content:this.replaceInContent(t,e.position.index,e.position.length,""),shouldDelete:!1,success:!1}}processDeleteDirectives(e,t,n,r){const i=this.contentDeletion.processDeleteDirectives(e,t,n,null);for(const[e,t]of i.modifiedFiles)n.set(e,t),t.markedForDeletion&&r.add(e);this.stats.deletedElements+=i.deletedPages.length+i.deletedSlides.length+i.deletedRows.length,i.errors.length>0&&this.options.logMissingData&&i.errors.forEach(e=>{console.warn(`Deletion error in ${e.file} (${e.type}): ${e.error}`)})}groupDeleteDirectivesByFile(e){const t=new Map;for(const n of e){const e=n.position.file;t.has(e)||t.set(e,[]),t.get(e).push(n)}return t}getDataValue(e,t){if(!e||!t)return null;const n=t.split(".");let r=e;for(const e of n){if(null==r||"object"!=typeof r)return null;r=r[e]}return void 0===r?null:r}isEmptyValue(e){return null==e||"string"==typeof e&&""===e.trim()||!(!Array.isArray(e)||0!==e.length)||"object"==typeof e&&0===Object.keys(e).length}replaceInContent(e,t,n,r){return e.slice(0,t)+r+e.slice(t+n)}resetStats(){this.stats={totalSubstitutions:0,successfulSubstitutions:0,failedSubstitutions:0,deletedElements:0}}getStats(){return{...this.stats,successRate:this.stats.totalSubstitutions>0?this.stats.successfulSubstitutions/this.stats.totalSubstitutions*100:0}}configure(e){this.options={...this.options,...e}}validateData(e,t){const n=[],r=[],i=[];for(const i of e.uniquePlaceholderList){null==this.getDataValue(t,i)?n.push(i):r.push(i)}for(const n of e.numericDirectives){const e=this.getDataValue(t,n.cleanName);null!=e&&isNaN(parseFloat(e))&&i.push({placeholder:n.cleanName,expected:"number",received:typeof e})}return{valid:0===n.length&&0===i.length,missing:n,available:r,typeErrors:i,coverage:e.uniquePlaceholderList.length>0?r.length/e.uniquePlaceholderList.length*100:100}}}},601:(e,t,n)=>{var r=n(287).hp;e.exports=function(e){var t=n(21),i={chunkSize:1024*(parseInt(e.length/1024)+1)};return{deflate:function(){return t.deflateRawSync(e,i)},deflateAsync:function(n){var o=t.createDeflateRaw(i),s=[],a=0;o.on("data",function(e){s.push(e),a+=e.length}),o.on("end",function(){var e=r.alloc(a),t=0;e.fill(0);for(var i=0;i<s.length;i++){var o=s[i];o.copy(e,t),t+=o.length}n&&n(e)}),o.end(e)}}}},603:()=>{},606:e=>{var t,n,r=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(e){n=o}}();var a,c=[],l=!1,f=-1;function u(){l&&a&&(l=!1,a.length?c=a.concat(c):f=-1,c.length&&d())}function d(){if(!l){var e=s(u);l=!0;for(var t=c.length;t;){for(a=c,c=[];++f<t;)a&&a[f].run();f=-1,t=c.length}a=null,l=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{return n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function p(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new h(e,t)),1!==c.length||l||s(d)},h.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=p,r.addListener=p,r.once=p,r.off=p,r.removeListener=p,r.removeAllListeners=p,r.emit=p,r.prependListener=p,r.prependOnceListener=p,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},626:e=>{e.exports=new class{constructor(){this.cache=new Map,this.zipLib=null,this.initializeZipLib()}initializeZipLib(){"undefined"!=typeof window&&window.zip?(this.zipLib=window.zip,this.zipLib.configure({useWebWorkers:!1})):console.warn("zip.js library not found. Please include zip.js before using this library.")}async extract(e){if(!this.zipLib)throw new Error("zip.js library not available. Please include zip.js in your HTML.");let t;if("string"==typeof e)if(this.cache.has(e))t=this.cache.get(e);else{const n=await fetch(e);if(!n.ok)throw new Error(`Failed to fetch ZIP file: ${n.statusText}`);t=await n.blob(),this.cache.set(e,t)}else t=e;const n=new this.zipLib.ZipReader(new this.zipLib.BlobReader(t)),r=await n.getEntries(),i={};for(const e of r)if(!e.directory){const t=await e.getData(new this.zipLib.TextWriter),n=await e.getData(new this.zipLib.BlobWriter);i[e.filename]={name:e.filename,content:t,buffer:n}}return await n.close(),{files:i,getFile:e=>i[e],getAllFiles:()=>Object.values(i),getXmlFiles:()=>Object.values(i).filter(e=>e.name.endsWith(".xml"))}}async create(e){if(!this.zipLib)throw new Error("zip.js library not available. Please include zip.js in your HTML.");const t=new this.zipLib.ZipWriter(new this.zipLib.BlobWriter("application/zip"));for(const[n,r]of Object.entries(e)){let e;if("string"==typeof r)e=new this.zipLib.TextReader(r);else if(r instanceof Blob)e=new this.zipLib.BlobReader(r);else if(r&&r.buffer instanceof Blob)e=new this.zipLib.BlobReader(r.buffer);else{if(!r||"string"!=typeof r.content)continue;e=new this.zipLib.TextReader(r.content)}await t.add(n,e)}return await t.close()}downloadBlob(e,t){if("undefined"==typeof window)throw new Error("downloadBlob is only available in browser environment");const n=URL.createObjectURL(e),r=document.createElement("a");r.href=n,r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(n)}clearCache(){this.cache.clear()}}},629:()=>{},673:()=>{},698:(e,t,n)=>{var r=n(287).hp;e.exports={efs:!0,encode:e=>r.from(e,"utf8"),decode:e=>e.toString("utf8")}},752:(e,t,n)=>{var r=n(287).hp;const i=n(283),o=n(92),s=n(497).promises;e.exports=new class{constructor(){this.cache=new Map}async extract(e){let t;if("string"==typeof e)if(this.cache.has(e))t=this.cache.get(e);else{if(e.startsWith("http://")||e.startsWith("https://")||e.startsWith("file://")){const n=await o(e);if(!n.ok)throw new Error(`Failed to fetch ZIP file: ${n.statusText}`);t=r.from(await n.arrayBuffer())}else t=await s.readFile(e);this.cache.set(e,t)}else t=e;const n=new i(t),a=n.getEntries(),c={};a.forEach(e=>{if(!e.isDirectory){const t=e.getData(),n=e.entryName.endsWith(".xml")||e.entryName.endsWith(".rels");c[e.entryName]={name:e.entryName,content:n?t.toString("utf8"):null,buffer:t}}});const l=await this.extractEmbeddedOfficeFiles(c);return{files:c,zip:n,embeddedFiles:l,getFile:e=>c[e],getAllFiles:()=>Object.values(c),getXmlFiles:()=>Object.values(c).filter(e=>e.name.endsWith(".xml"))}}async extractEmbeddedOfficeFiles(e){const t={};for(const[n,r]of Object.entries(e))if((n.includes("/embeddings/")||n.includes("\\embeddings\\"))&&(n.endsWith(".xlsx")||n.endsWith(".docx")||n.endsWith(".pptx"))&&r.buffer)try{const e=new i(r.buffer).getEntries(),o={};e.forEach(e=>{if(!e.isDirectory){const t=e.getData(),n=e.entryName.endsWith(".xml")||e.entryName.endsWith(".rels");o[e.entryName]={name:e.entryName,content:n?t.toString("utf8"):null,buffer:t}}}),t[n]={path:n,files:o,originalBuffer:r.buffer}}catch(e){console.warn(`Failed to extract embedded file ${n}: ${e.message}`)}return t}async recreateEmbeddedOfficeFile(e){const t=new i;for(const[n,i]of Object.entries(e.files))if("string"==typeof i)t.addFile(n,r.from(i,"utf8"));else if(r.isBuffer(i))t.addFile(n,i);else if(i&&i.buffer){const e=n.endsWith(".xml")||n.endsWith(".rels");t.addFile(n,e&&i.content?r.from(i.content,"utf8"):i.buffer)}return t.toBuffer()}async create(e){const t=new i;for(const[n,i]of Object.entries(e))"string"==typeof i?t.addFile(n,r.from(i,"utf8")):r.isBuffer(i)?t.addFile(n,i):i&&i.buffer&&t.addFile(n,i.buffer);return t.toBuffer()}async saveToFile(e,t){await s.writeFile(t,e)}clearCache(){this.cache.clear()}}},776:(e,t,n)=>{t.Deflater=n(601),t.Inflater=n(821),t.ZipCrypto=n(14)},780:(e,t,n)=>{t.EntryHeader=n(593),t.MainHeader=n(138)},819:(e,t,n)=>{const r=n(673);e.exports=function(e,{fs:t}){var n=e||"",i={directory:!1,readonly:!1,hidden:!1,executable:!1,mtime:0,atime:0},o=null;return n&&t.existsSync(n)?(o=t.statSync(n),i.directory=o.isDirectory(),i.mtime=o.mtime,i.atime=o.atime,i.executable=!!(73&o.mode),i.readonly=!(128&o.mode),i.hidden="."===r.basename(n)[0]):console.warn("Invalid path: "+n),{get directory(){return i.directory},get readOnly(){return i.readonly},get hidden(){return i.hidden},get mtime(){return i.mtime},get atime(){return i.atime},get executable(){return i.executable},decodeAttributes:function(){},encodeAttributes:function(){},toJSON:function(){return{path:n,isDirectory:i.directory,isReadOnly:i.readonly,isHidden:i.hidden,isExecutable:i.executable,mTime:i.mtime,aTime:i.atime}},toString:function(){return JSON.stringify(this.toJSON(),null,"\t")}}}},821:(e,t,n)=>{var r=n(606),i=n(287).hp;const o=+(r.versions?r.versions.node:"").split(".")[0]||0;e.exports=function(e,t){var r=n(21);const s=o>=15&&t>0?{maxOutputLength:t}:{};return{inflate:function(){return r.inflateRawSync(e,s)},inflateAsync:function(t){var n=r.createInflateRaw(s),o=[],a=0;n.on("data",function(e){o.push(e),a+=e.length}),n.on("end",function(){var e=i.alloc(a),n=0;e.fill(0);for(var r=0;r<o.length;r++){var s=o[r];s.copy(e,n),n+=s.length}t&&t(e)}),n.end(e)}}}},954:(e,t,n)=>{const r="undefined"==typeof window&&void 0!==n.g,i="undefined"!=typeof window;let o;r?o=n(752):i&&(o=n(626));const s=n(573),a=n(599),c=n(989),{fetchTemplate:l,detectMimeType:f,detectDocumentType:u,extractFilename:d}=n(489);class h{constructor(e={}){this.options={cacheTemplates:!0,...e,environment:r?"node":"browser"},this.zipHandler=o,this.placeholderParser=new s,this.placeholderSubstitution=new a,this.xmlParser=c}async parseTemplate(e,t={}){try{const t=await l(e),n=await this.zipHandler.extract(t),r=this.xmlParser.discoverXmlFiles(n),i=this.placeholderParser.parseDocument(n,r),o=u(e);return{success:!0,template:{url:e,type:o,mimeType:f(e),filename:d(e)},placeholders:{all:i.placeholders,unique:i.uniquePlaceholderList,numeric:i.numericDirectives,delete:i.deleteDirectives},statistics:{totalPlaceholders:i.summary.totalPlaceholders,uniquePlaceholders:i.summary.uniqueCount,numericDirectives:i.summary.numericDirectiveCount,deleteDirectives:i.summary.deleteDirectiveCount,xmlFiles:r.length},metadata:{parsedAt:(new Date).toISOString(),environment:this.options.environment}}}catch(t){return{success:!1,error:{message:t.message,stack:t.stack},template:{url:e}}}}async fetchData(e,t,i={}){try{const o={method:"POST",headers:{"Content-Type":"application/json",...i.headers},body:JSON.stringify({placeholders:t,...i.additionalData}),...i.fetchOptions};let s;if(r)if("undefined"==typeof fetch)try{const t=n(92);s=await t(e,o)}catch{throw new Error("fetch is not available. Please use Node.js 18+ or install node-fetch")}else s=await fetch(e,o);else s=await fetch(e,o);if(!s.ok)throw new Error(`API request failed: ${s.status} ${s.statusText}`);const a=await s.json(),c=a.data||a.values||a.placeholders||a;return i.returnFullResponse?{success:!0,data:c,filename:a.filename||i.defaultFilename||null,metadata:{fetchedAt:(new Date).toISOString(),apiUrl:e,placeholderCount:t.length},rawResponse:i.includeRawResponse?a:void 0}:c}catch(n){return{success:!1,error:{message:n.message,stack:n.stack,type:n.name},apiUrl:e,placeholders:t}}}async substituteTemplate(e,t,n={}){try{const r=await l(e),i=await this.zipHandler.extract(r),o=this.xmlParser.discoverXmlFiles(i),s=this.placeholderParser.parseDocument(i,o),a=this.placeholderSubstitution.substituteDocument(s,t,o,{strictMode:n.strictMode||!1,preserveUnmatched:!1!==n.preserveUnmatched,logMissingData:!1!==n.logMissingData,deleteEmptyElements:!1!==n.deleteEmptyElements}),c={},h=i.files||i;for(const[e,t]of Object.entries(h))if("string"==typeof t)c[e]=t;else if(t&&t.buffer){const n=e.endsWith(".xml")||e.endsWith(".rels");c[e]=n&&t.content?t.content:t.buffer}else t&&void 0!==t.content?c[e]=t.content:c[e]=t;for(const[e,t]of a.modifiedFiles)e.includes(".xlsx/")||e.includes(".docx/")||e.includes(".pptx/")||(t&&void 0!==t.content?c[e]=t.content:c[e]=t);if(i.embeddedFiles)for(const[e,t]of Object.entries(i.embeddedFiles)){const n={};let r=!1;for(const[i,o]of Object.entries(t.files)){const t=`${e}/${i}`,s=a.modifiedFiles.get(t);s?(r=!0,n[i]=s.content||s):n[i]=o}if(r){const t=await this.zipHandler.recreateEmbeddedOfficeFile({path:e,files:n});c[e]=t}}const p=await this.zipHandler.create(c),m=u(e);return{success:!0,document:p,template:{url:e,type:m,mimeType:f(e),filename:d(e)},substitution:{stats:a.stats,deletionCandidates:a.deletionCandidates},metadata:{substitutedAt:(new Date).toISOString(),environment:this.options.environment}}}catch(t){return{success:!1,error:{message:t.message,stack:t.stack,type:t.name},template:{url:e}}}}downloadDocument(e,t={}){if(!i)return{success:!1,error:{message:"downloadDocument is only available in browser environment",type:"EnvironmentError"}};try{const n=t.filename||"document.docx",r=t.mimeType||f(n),i=new Blob([e],{type:r}),o=window.URL.createObjectURL(i),s=document.createElement("a");return s.href=o,s.download=n,document.body.appendChild(s),s.click(),document.body.removeChild(s),window.URL.revokeObjectURL(o),{success:!0,filename:n,mimeType:r,size:e.length,metadata:{downloadedAt:(new Date).toISOString()}}}catch(e){return{success:!1,error:{message:e.message,stack:e.stack,type:e.name}}}}async saveDocument(e,t,i={}){if(!r)return{success:!1,error:{message:"saveDocument is only available in Node.js environment",type:"EnvironmentError"}};try{const r=n(603).promises,i=n(247),o=i.dirname(t);await r.mkdir(o,{recursive:!0}),await r.writeFile(t,e);const s=await r.stat(t);return{success:!0,path:t,filename:i.basename(t),size:s.size,metadata:{savedAt:(new Date).toISOString(),absolutePath:i.resolve(t)}}}catch(e){return{success:!1,error:{message:e.message,stack:e.stack,type:e.name},path:t}}}async processTemplate(e,t,n={}){try{let r;const o=await this.parseTemplate(e);if(!o.success)throw new Error(`Template parsing failed: ${o.error.message}`);if("string"==typeof t){const e=await this.fetchData(t,o.placeholders.unique,n.fetchOptions||{});if(!e.success)throw new Error(`Data fetching failed: ${e.error.message}`);r=e.data,e.filename&&!n.filename&&(n.filename=e.filename)}else r=t;const s=await this.substituteTemplate(e,r,n.substitutionOptions||{});if(!s.success)throw new Error(`Substitution failed: ${s.error.message}`);const a=n.filename||s.template.filename||"output.docx",c=n.mimeType||s.template.mimeType;let l;return l=n.outputPath?await this.saveDocument(s.document,n.outputPath):n.download&&i?this.downloadDocument(s.document,{filename:a,mimeType:c}):{success:!0,type:"buffer",document:s.document},{success:!0,document:s.document,output:l,template:s.template,parsing:{placeholders:o.placeholders,statistics:o.statistics},substitution:s.substitution,metadata:{processedAt:(new Date).toISOString(),environment:this.options.environment}}}catch(t){return{success:!1,error:{message:t.message,stack:t.stack,type:t.name},template:{url:e}}}}async generateDocument(e,t){throw new Error("generateDocument not yet implemented - use processTemplate instead")}}e.exports=h,e.exports.OOXMLTemplater=h,e.exports.default=h,i&&"undefined"!=typeof window&&(window.OOXMLTemplater=h)},989:e=>{e.exports=new class{constructor(){this.xmlPatterns={word:["word/document.xml","word/header*.xml","word/footer*.xml","word/comments.xml","word/footnotes.xml","word/endnotes.xml"],powerpoint:["ppt/slides/slide*.xml","ppt/slideLayouts/slideLayout*.xml","ppt/slideMasters/slideMaster*.xml","ppt/notesSlides/notesSlide*.xml","ppt/comments/comment*.xml"],excel:["xl/worksheets/sheet*.xml","xl/sharedStrings.xml","xl/comments*.xml","xl/drawings/drawing*.xml"],embedded:["word/embeddings/**/*.xml","ppt/embeddings/**/*.xml","xl/embeddings/**/*.xml","ppt/charts/chart*.xml","xl/charts/chart*.xml"]}}discoverXmlFiles(e){const t=[],n=e.getAllFiles();for(const e of n)if(this.isXmlFile(e.name)){const n={path:e.name,content:e.content,buffer:e.buffer,type:this.getFileType(e.name),category:this.getFileCategory(e.name),isEmbedded:this.isEmbeddedFile(e.name)};t.push(n)}if(e.embeddedFiles)for(const[n,r]of Object.entries(e.embeddedFiles))for(const[e,i]of Object.entries(r.files))if(this.isXmlFile(e)){const r={path:`${n}/${e}`,content:i.content,buffer:i.buffer,type:this.getFileType(e),category:this.getFileCategory(e),isEmbedded:!0,embeddedParent:n,embeddedInternalPath:e};t.push(r)}return this.sortXmlFiles(t)}isXmlFile(e){return e.toLowerCase().endsWith(".xml")||e.toLowerCase().endsWith(".rels")}getFileType(e){const t=e.toLowerCase();return t.includes("chart")?"chart":t.includes("drawing")?"drawing":t.startsWith("word/")?"word":t.startsWith("ppt/")?"powerpoint":t.startsWith("xl/")?"excel":"other"}getFileCategory(e){const t=e.toLowerCase();return t.endsWith(".rels")?"relationships":t.includes("notes")?"notes":t.includes("chart")?"chart":t.includes("drawing")?"drawing":t.includes("header")||t.includes("footer")?"headerFooter":t.includes("comment")?"comments":t.includes("document.xml")||t.includes("slide")||t.includes("sheet")?"content":"other"}isEmbeddedFile(e){const t=e.toLowerCase();return t.includes("embedding")||t.includes("chart")||t.includes("xl/")&&t.includes("ppt/")||t.includes("word/")&&(t.includes("xl/")||t.includes("ppt/"))}sortXmlFiles(e){const t={content:1,chart:2,drawing:3,headerFooter:4,comments:5,notes:6,relationships:7,other:8};return e.sort((e,n)=>{const r=t[e.category]||9,i=t[n.category]||9;return r!==i?r-i:e.isEmbedded!==n.isEmbedded?e.isEmbedded?1:-1:e.path.localeCompare(n.path)})}parseXmlContent(e){try{return{originalContent:e,textContent:this.extractTextContent(e),xmlStructure:this.analyzeXmlStructure(e),hasContent:e.trim().length>0}}catch(t){return{originalContent:e,textContent:"",xmlStructure:{elements:[],attributes:[]},hasContent:!1,error:t.message}}}extractTextContent(e){return e?e.replace(/<[^>]*>/g," ").replace(/\s+/g," ").trim():""}analyzeXmlStructure(e){if(!e)return{elements:[],attributes:[]};const t=[],n=[],r=/<([^/\s>]+)[^>]*>/g;let i;for(;null!==(i=r.exec(e));){const e=i[1];t.includes(e)||t.push(e)}const o=/(\w+)=["']([^"']*\(\(\([^)]*\)\)\)[^"']*)["']/g;for(;null!==(i=o.exec(e));)n.push({name:i[1],value:i[2]});return{elements:t,attributes:n}}getFilePatternsForType(e){return[...this.xmlPatterns[e]||[],...this.xmlPatterns.embedded]}hasPlaceholderPatterns(e){return!!e&&[/\(\(\([^)]+\)\)\)/,/\(\(\(\d+=\w+[^)]*\)\)\)/,/\(\(\(Delete\w+[^)]*\)\)\)/].some(t=>t.test(e))}}}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}();var r=n(954);return r.default})());